[
  {
    "objectID": "viz.html",
    "href": "viz.html",
    "title": "Data Alchemists",
    "section": "",
    "text": "import matplotlib.pyplot as plt\nimport fastf1.plotting\nfastf1.plotting.setup_mpl(misc_mpl_mods=False)\nfastf1.Cache.enable_cache('D:\\\\')\nsession = fastf1.get_session(2024, 1, 'R')\nsession.load(telemetry=False, weather=False)\nfig, ax = plt.subplots(figsize=(8.0, 4.9))\nfor drv in session.drivers:\n    drv_laps = session.laps.pick_driver(drv)\n\n    abb = drv_laps['Driver'].iloc[0]\n    color = fastf1.plotting.driver_color(abb)\n\n    ax.plot(drv_laps['LapNumber'], drv_laps['Position'],\n            label=abb, color=color)\nax.set_ylim([20.5, 0.5])\nax.set_yticks([1, 5, 10, 15, 20])\nax.set_xlabel('Lap')\nax.set_ylabel('Position')\nax.legend(bbox_to_anchor=(1.0, 1.02))\nplt.tight_layout()\nplt.suptitle(f\"Position Comparison by Laps \"\n             f\"{session.event['EventName']} {session.event.year} Race\")\nplt.show()\n\ncore           INFO     Loading data for Bahrain Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '11', '55', '16', '63', '4', '44', '81', '14', '18', '24', '20', '3', '22', '23', '27', '31', '10', '77', '2']\n\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport fastf1.plotting\nfastf1.plotting.setup_mpl(misc_mpl_mods=False)\nfastf1.Cache.enable_cache('D:\\\\')\nsession2 = fastf1.get_session(2024, 2, 'R')\nsession2.load()\nver_lap = session2.laps.pick_driver('VER').pick_fastest()\nper_lap = session2.laps.pick_driver('LEC').pick_fastest()\nver_tel = ver_lap.get_car_data().add_distance()\nlec_tel = per_lap.get_car_data().add_distance()\n\nver_color = fastf1.plotting.driver_color('VER')\nlec_color = fastf1.plotting.driver_color('LEC')\n\nfig, ax = plt.subplots()\nax.plot(ver_tel['Distance'], ver_tel['Speed'], color=ver_color, label='VER')\nax.plot(lec_tel['Distance'], lec_tel['Speed'], color=lec_color, label='LEC')\n\nax.set_xlabel('Distance in m')\nax.set_ylabel('Speed in km/h')\n\nax.legend()\nplt.suptitle(f\"Fastest Lap Comparison \\n \"\n             \"Saudi Arabian Grand Prix 2024 Race\")\n\nplt.show()\n\ncore           INFO     Loading data for Saudi Arabian Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '11', '16', '81', '14', '63', '38', '4', '44', '27', '23', '20', '31', '2', '22', '3', '77', '24', '18', '10']\n\n\n\n\n\n\n\n\n\n\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nimport fastf1\nimport fastf1.plotting\nfastf1.Cache.enable_cache('D:\\\\')\nfastf1.plotting.setup_mpl(misc_mpl_mods=False)\nsession3 = fastf1.get_session(2024, 3, 'R')\nsession3.load()\ndriver_laps = session3.laps.pick_driver(\"SAI\").pick_quicklaps().reset_index()\nfig, ax = plt.subplots(figsize=(8, 8))\n\nsns.scatterplot(data=driver_laps,\n                x=\"LapNumber\",\n                y=\"LapTime\",\n                ax=ax,\n                hue=\"Compound\",\n                palette=fastf1.plotting.COMPOUND_COLORS,\n                s=80,\n                linewidth=0,\n                legend='auto')\nax.set_xlabel(\"Lap Number\")\nax.set_ylabel(\"Lap Time\")\nax.invert_yaxis()\nplt.suptitle(\"Carlos Sainz Laptimes in the 2024 Australian Grand Prix\")\nplt.grid(color='w', which='major', axis='both')\nsns.despine(left=True, bottom=True)\nplt.tight_layout()\nplt.show()\n\ncore           INFO     Loading data for Australian Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 19 drivers: ['55', '16', '4', '81', '11', '18', '22', '14', '27', '20', '23', '3', '10', '77', '24', '31', '63', '44', '1']\n\n\n\n\n\n\n\n\n\n\nimport matplotlib as mpl\nimport numpy as np\nfrom matplotlib import pyplot as plt\nfrom matplotlib.collections import LineCollection\nfrom matplotlib import colormaps\nimport fastf1 as ff1\nff1.Cache.enable_cache('D:\\\\')  # adjust \nsession4 = ff1.get_session(2024,4,'R')\nsession4.load()\nlaps=session4.laps\nfastest_lap = laps.pick_fastest()\ntelemetry = fastest_lap.get_telemetry()\nx = np.array(telemetry['X'].values)\ny = np.array(telemetry['Y'].values)\npoints = np.array([x, y]).T.reshape(-1, 1, 2)\nsegments = np.concatenate([points[:-1], points[1:]], axis=1)\ngear = telemetry['nGear'].to_numpy().astype(float)\ncmap = colormaps['Paired']\nlc_comp = LineCollection(segments, norm=plt.Normalize(1, cmap.N+1), cmap=cmap)\nlc_comp.set_array(gear)\nlc_comp.set_linewidth(4)\nplt.gca().add_collection(lc_comp)\nplt.axis('equal')\nplt.tick_params(labelleft=False, left=False, labelbottom=False, bottom=False)\ntitle = plt.suptitle(\n    f\"Fastest Lap Gear Shift Visualization\\n\"\n    f\"{fastest_lap['Driver']} - {session4.event['EventName']} {session4.event.year}\"\n)\ncbar = plt.colorbar(mappable=lc_comp, label=\"Gear\",\n                    boundaries=np.arange(1, 10))\ncbar.set_ticks(np.arange(1.5, 9.5))\ncbar.set_ticklabels(np.arange(1, 9))\nplt.show()\n\ncore           INFO     Loading data for Japanese Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '11', '55', '16', '4', '14', '63', '81', '44', '22', '27', '18', '20', '77', '31', '10', '2', '24', '3', '23']\n\n\n\n\n\n\n\n\n\n\nimport matplotlib as mpl\nimport numpy as np\nfrom matplotlib import pyplot as plt\nfrom matplotlib.collections import LineCollection\nimport fastf1 as ff1\nff1.Cache.enable_cache('D:\\\\')  # adjust \nyear = 2024\nwknd = 5\nses = 'R'\ndriver = 'ALO'\ncolormap = mpl.cm.plasma\nsession = ff1.get_session(year, wknd, ses)\nweekend = session.event\nsession.load()\nlap = session.laps.pick_driver(driver).pick_fastest()\nx = lap.telemetry['X']            \ny = lap.telemetry['Y']            \ncolor = lap.telemetry['Speed'] \npoints = np.array([x, y]).T.reshape(-1, 1, 2)\nsegments = np.concatenate([points[:-1], points[1:]], axis=1)\n# We create a plot with title and adjust some setting to make it look good.\nfig, ax = plt.subplots(sharex=True, sharey=True, figsize=(12, 6.75))\nfig.suptitle('Chinese Grand Prix 2024, Alonso Speed Map', size=24, y=0.97)\n\n# Adjust margins and turn of axis\nplt.subplots_adjust(left=0.1, right=0.9, top=0.9, bottom=0.12)\nax.axis('off')\n\n\n# After this, we plot the data itself.\n# Create background track line\nax.plot(lap.telemetry['X'], lap.telemetry['Y'],\n        color='black', linestyle='-', linewidth=16, zorder=0)\n\n# Create a continuous norm to map from data points to colors\nnorm = plt.Normalize(color.min(), color.max())\nlc = LineCollection(segments, cmap=colormap, norm=norm,\n                    linestyle='-', linewidth=5)\n\n# Set the values used for colormapping\nlc.set_array(color)\n\n# Merge all line segments together\nline = ax.add_collection(lc)\n\n\n# Finally, we create a color bar as a legend.\ncbaxes = fig.add_axes([0.25, 0.05, 0.5, 0.05])\nnormlegend = mpl.colors.Normalize(vmin=color.min(), vmax=color.max())\nlegend = mpl.colorbar.ColorbarBase(cbaxes, norm=normlegend, cmap=colormap,\n                                   orientation=\"horizontal\")\n\n\n# Show the plot\nplt.show()\n\ncore           INFO     Loading data for Chinese Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '4', '11', '16', '55', '63', '14', '81', '44', '27', '31', '23', '10', '24', '18', '20', '2', '3', '22', '77']\ncore        WARNING     Failed to preserve data type for column 'X' while merging telemetry.\ncore        WARNING     Failed to preserve data type for column 'Y' while merging telemetry.\ncore        WARNING     Failed to preserve data type for column 'Z' while merging telemetry.\n\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport fastf1.plotting\nfastf1.Cache.enable_cache('D:\\\\')\nfastf1.plotting.setup_mpl(misc_mpl_mods=False)\nsession = fastf1.get_session(2023, 22, 'R')\nsession.load()\nfastest_lap = session.laps.pick_fastest()\ncar_data = fastest_lap.get_car_data().add_distance()\ncircuit_info = session.get_circuit_info()\nteam_color = fastf1.plotting.team_color(fastest_lap['Team'])\n\nfig, ax = plt.subplots()\nax.plot(car_data['Distance'], car_data['Speed'],\n        color=team_color, label=fastest_lap['Driver'])\n\n# Draw vertical dotted lines at each corner that range from slightly below the\n# minimum speed to slightly above the maximum speed.\nv_min = car_data['Speed'].min()\nv_max = car_data['Speed'].max()\nax.vlines(x=circuit_info.corners['Distance'], ymin=v_min-20, ymax=v_max+20,\n          linestyles='dotted', colors='grey')\n\n# Plot the corner number just below each vertical line.\n# For corners that are very close together, the text may overlap. A more\n# complicated approach would be necessary to reliably prevent this.\nfor _, corner in circuit_info.corners.iterrows():\n    txt = f\"{corner['Number']}{corner['Letter']}\"\n    ax.text(corner['Distance'], v_min-30, txt,\n            va='center_baseline', ha='center', size='small')\n\nax.set_xlabel('Distance in m')\nax.set_ylabel('Speed in km/h')\nax.legend()\n\n# Manually adjust the y-axis limits to include the corner numbers, because\n# Matplotlib does not automatically account for text that was manually added.\nax.set_ylim([v_min - 40, v_max + 20])\n\nplt.show()\n\ncore           INFO     Loading data for Abu Dhabi Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '16', '63', '11', '4', '81', '14', '22', '44', '18', '3', '31', '10', '23', '27', '2', '24', '55', '77', '20']\n\n\n\n\n\n\n\n\n\n\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n\nimport fastf1\nimport fastf1.plotting\nfastf1.Cache.enable_cache('D:\\\\')\n\n# enabling misc_mpl_mods will turn on minor grid lines that clutters the plot\nfastf1.plotting.setup_mpl(mpl_timedelta_support=False, misc_mpl_mods=False)\nrace = fastf1.get_session(2023, \"Monaco\", 'R')\nrace.load()\npoint_finishers = race.drivers[:10]\nprint(point_finishers)\ndriver_laps = race.laps.pick_drivers(point_finishers).pick_quicklaps()\ndriver_laps = driver_laps.reset_index()\nfinishing_order = [race.get_driver(i)[\"Abbreviation\"] for i in point_finishers]\nprint(finishing_order)\ndriver_colors = {abv: fastf1.plotting.DRIVER_COLORS[driver] for abv,\n                 driver in fastf1.plotting.DRIVER_TRANSLATE.items()}\nprint(driver_colors)\n# create the figure\nfig, ax = plt.subplots(figsize=(10, 5))\n\n# Seaborn doesn't have proper timedelta support\n# so we have to convert timedelta to float (in seconds)\ndriver_laps[\"LapTime(s)\"] = driver_laps[\"LapTime\"].dt.total_seconds()\n\nsns.violinplot(data=driver_laps,\n               x=\"Driver\",\n               y=\"LapTime(s)\",\n               hue=\"Driver\",\n               inner=None,\n               density_norm=\"area\",\n               order=finishing_order,\n               palette=driver_colors\n               )\n\nsns.swarmplot(data=driver_laps,\n              x=\"Driver\",\n              y=\"LapTime(s)\",\n              order=finishing_order,\n              hue=\"Compound\",\n              palette=fastf1.plotting.COMPOUND_COLORS,\n              hue_order=[\"SOFT\", \"MEDIUM\", \"HARD\"],\n              linewidth=0,\n              size=4,\n              )\nax.set_xlabel(\"Driver\")\nax.set_ylabel(\"Lap Time (s)\")\nplt.suptitle(\"2023 Monaco Grand Prix Lap Time Distributions\")\nsns.despine(left=True, bottom=True)\n\nplt.tight_layout()\nplt.show()    \n\ncore           INFO     Loading data for Monaco Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '14', '31', '44', '63', '16', '10', '55', '4', '81', '77', '21', '24', '23', '22', '11', '27', '2', '20', '18']\n\n\n['1', '14', '31', '44', '63', '16', '10', '55', '4', '81']\n['VER', 'ALO', 'OCO', 'HAM', 'RUS', 'LEC', 'GAS', 'SAI', 'NOR', 'PIA']\n{'LEC': '#dc0000', 'SAI': '#ff8181', 'SHW': '#9c0000', 'VER': '#fcd700', 'PER': '#ffec7b', 'DEN': '#907400', 'PIA': '#ff8700', 'NOR': '#eeb370', 'OWA': '#ee6d3a', 'GAS': '#fe86bc', 'OCO': '#ff117c', 'DOO': '#894667', 'BOT': '#00e701', 'ZHO': '#008d01', 'POU': '#004601', 'DEV': '#1e3d61', 'TSU': '#356cac', 'RIC': '#2b4562', 'LAW': '#2b4562', 'HAD': '#1e6176', 'IWA': '#1e6176', 'MAG': '#ffffff', 'HUL': '#cacaca', 'BEA': '#c40000', 'ALO': '#006f62', 'STR': '#00413b', 'DRU': '#2f9b90', 'HAM': '#00d2be', 'RUS': '#24ffff', 'VES': '#00a6ff', 'ALB': '#005aff', 'SAR': '#012564', 'OSU': '#1b3d97'}\n\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nimport fastf1\n\nfastf1.Cache.enable_cache('D:\\\\')\nsession = fastf1.get_session(2023, 'Miami', 'R')\nsession.load()\n\nlap = session.laps.pick_fastest()\npos = lap.get_pos_data()\n\ncircuit_info = session.get_circuit_info()\ndef rotate(xy, *, angle):\n    rot_mat = np.array([[np.cos(angle), np.sin(angle)],\n                        [-np.sin(angle), np.cos(angle)]])\n    return np.matmul(xy, rot_mat)\n# Get an array of shape [n, 2] where n is the number of points and the second\n# axis is x and y.\ntrack = pos.loc[:, ('X', 'Y')].to_numpy()\n\n# Convert the rotation angle from degrees to radian.\ntrack_angle = circuit_info.rotation / 180 * np.pi\n\n# Rotate and plot the track map.\nrotated_track = rotate(track, angle=track_angle)\nplt.plot(rotated_track[:, 0], rotated_track[:, 1])\noffset_vector = [500, 0]  # offset length is chosen arbitrarily to 'look good'\n\n# Iterate over all corners.\nfor _, corner in circuit_info.corners.iterrows():\n    # Create a string from corner number and letter\n    txt = f\"{corner['Number']}{corner['Letter']}\"\n\n    # Convert the angle from degrees to radian.\n    offset_angle = corner['Angle'] / 180 * np.pi\n\n    # Rotate the offset vector so that it points sideways from the track.\n    offset_x, offset_y = rotate(offset_vector, angle=offset_angle)\n\n    # Add the offset to the position of the corner\n    text_x = corner['X'] + offset_x\n    text_y = corner['Y'] + offset_y\n\n    # Rotate the text position equivalently to the rest of the track map\n    text_x, text_y = rotate([text_x, text_y], angle=track_angle)\n\n    # Rotate the center of the corner equivalently to the rest of the track map\n    track_x, track_y = rotate([corner['X'], corner['Y']], angle=track_angle)\n\n    # Draw a circle next to the track.\n    plt.scatter(text_x, text_y, color='grey', s=140)\n\n    # Draw a line from the track to this circle.\n    plt.plot([track_x, text_x], [track_y, text_y], color='grey')\n\n    # Finally, print the corner number inside the circle.\n    plt.text(text_x, text_y, txt,\n             va='center_baseline', ha='center', size='small', color='white')\nplt.title(session.event['Location'])\nplt.xticks([])\nplt.yticks([])\nplt.axis('equal')\nplt.show()\n\ncore           INFO     Loading data for Miami Grand Prix - Race [v3.3.3]\nreq            INFO     Using cached data for session_info\nreq            INFO     Using cached data for driver_info\nreq            INFO     Using cached data for session_status_data\nreq            INFO     Using cached data for lap_count\nreq            INFO     Using cached data for track_status_data\nreq            INFO     Using cached data for _extended_timing_data\nreq            INFO     Using cached data for timing_app_data\ncore           INFO     Processing timing data...\nreq            INFO     Using cached data for car_data\nreq            INFO     Using cached data for position_data\nreq            INFO     Using cached data for weather_data\nreq            INFO     Using cached data for race_control_messages\ncore           INFO     Finished loading data for 20 drivers: ['1', '11', '14', '63', '55', '44', '16', '10', '31', '20', '22', '18', '77', '23', '27', '24', '4', '21', '81', '2']\ncore        WARNING     Failed to preserve data type for column 'X' while merging telemetry.\ncore        WARNING     Failed to preserve data type for column 'Y' while merging telemetry.\ncore        WARNING     Failed to preserve data type for column 'Z' while merging telemetry.\n\n\n\n\n\n\n\n\n\n\nimport pandas as pd\nimport plotly.express as px\nfrom plotly.io import show\nfastf1.Cache.enable_cache('D:\\\\')\nfrom fastf1.ergast import Ergast\nergast = Ergast()\nraces = ergast.get_race_schedule(2023)  # Races in year 2022\nresults = []\n\n# For each race in the season\nfor rnd, race in races['raceName'].items():\n\n    # Get results. Note that we use the round no. + 1, because the round no.\n    # starts from one (1) instead of zero (0)\n    temp = ergast.get_race_results(season=2023, round=rnd + 1)\n    temp = temp.content[0]\n\n    # If there is a sprint, get the results as well\n    sprint = ergast.get_sprint_results(season=2023, round=rnd + 1)\n    if sprint.content and sprint.description['round'][0] == rnd + 1:\n        temp = pd.merge(temp, sprint.content[0], on='driverCode', how='left')\n        # Add sprint points and race points to get the total\n        temp['points'] = temp['points_x'] + temp['points_y']\n        temp.drop(columns=['points_x', 'points_y'], inplace=True)\n\n    # Add round no. and grand prix name\n    temp['round'] = rnd + 1\n    temp['race'] = race.removesuffix(' Grand Prix')\n    temp = temp[['round', 'race', 'driverCode', 'points']]  # Keep useful cols.\n    results.append(temp)\n\n# Append all races into a single dataframe\nresults = pd.concat(results)\nraces = results['race'].drop_duplicates()\nresults = results.pivot(index='driverCode', columns='round', values='points')\n# Here we have a 22-by-22 matrix (22 races and 22 drivers, incl. DEV and HUL)\n\n# Rank the drivers by their total points\nresults['total_points'] = results.sum(axis=1)\nresults = results.sort_values(by='total_points', ascending=False)\nresults.drop(columns='total_points', inplace=True)\n\n# Use race name, instead of round no., as column names\nresults.columns = races\nfig = px.imshow(\n    results,\n    text_auto=True,\n    aspect='auto',  # Automatically adjust the aspect ratio\n    color_continuous_scale=[[0,    'rgb(198, 219, 239)'],  # Blue scale\n                            [0.25, 'rgb(107, 174, 214)'],\n                            [0.5,  'rgb(33,  113, 181)'],\n                            [0.75, 'rgb(8,   81,  156)'],\n                            [1,    'rgb(8,   48,  107)']],\n    labels={'x': 'Race',\n            'y': 'Driver',\n            'color': 'Points'}       # Change hover texts\n)\nfig.update_xaxes(title_text='')      # Remove axis titles\nfig.update_yaxes(title_text='')\nfig.update_yaxes(tickmode='linear')  # Show all ticks, i.e. driver names\nfig.update_yaxes(showgrid=True, gridwidth=1, gridcolor='LightGrey',\n                 showline=False,\n                 tickson='boundaries')              # Show horizontal grid only\nfig.update_xaxes(showgrid=False, showline=False)    # And remove vertical grid\nfig.update_layout(plot_bgcolor='rgba(0,0,0,0)')     # White background\nfig.update_layout(coloraxis_showscale=False)        # Remove legend\nfig.update_layout(xaxis=dict(side='top'))           # x-axis on top\nfig.update_layout(margin=dict(l=0, r=0, b=0, t=0))  # Remove border margins\nfig\nshow(fig)\n\n                                                \n\n\n\n# #| label: tenth\n# import plotly.graph_objects as go\n# import fastf1 as ff1\n\n# # Enable caching to speed up data loading\n# ff1.Cache.enable_cache('D:\\\\')  # Adjust this path as needed\n\n# # Load the session data\n# session = ff1.get_session(2023, 15, 'R')\n# session.load()\n\n# # Get the fastest lap and its telemetry data\n# laps = session.laps\n# fastest_lap = laps.pick_fastest()\n# telemetry = fastest_lap.get_telemetry()\n\n# # Create a Plotly scatter plot with the telemetry data focused on brake usage\n# fig = go.Figure()\n\n# # Adding the telemetry trace for brake usage\n# fig.add_trace(go.Scatter(x=telemetry['X'], y=telemetry['Y'], mode='markers',\n#                          marker=dict(size=telemetry['Speed']/30,  # Smaller marker size for higher speeds\n#                                      color=telemetry['Brake'],  # Brake data for coloring\n#                                      colorscale='YlOrRd',  # Yellow to Red color scale\n#                                      cmin=0, cmax=1, colorbar=dict(title='Brake Intensity')),\n#                          hoverinfo='text',\n#                          hovertext=\n#                          'Brake: ' + telemetry['Brake'].astype(str) +\n#                          '&lt;br&gt;RPM: ' + telemetry['RPM'].astype(str) +\n#                          '&lt;br&gt;Speed: ' + telemetry['Speed'].astype(str) + ' km/h'\n#                          ))\n\n# # Set layout properties\n# fig.update_layout(title=f\"Interactive Brake Usage Map: {fastest_lap['Driver']} - {session.event['EventName']} {session.event.year}\",\n#                   xaxis_title=\"X Coordinate\",\n#                   yaxis_title=\"Y Coordinate\",\n#                   xaxis_showgrid=False,\n#                   yaxis_showgrid=False,\n#                   margin=dict(l=0, r=0, t=50, b=0))\n\n# # Show the figure\n# fig.show()\n\n\n# import dash\n# from dash import dcc, html\n# from dash.dependencies import Input, Output\n# import plotly.graph_objects as go\n# import fastf1\n# from fastf1 import plotting\n# import pandas as pd\n# from IPython.display import display\n# import plotly.io as pio\n# pio.renderers.default = \"plotly_mimetype+notebook_connected\"\n\n\n\n# # Load the session data\n# session = fastf1.get_session(2023, 12, 'R')\n# session.load()  # Load all laps with telemetry\n\n# app = dash.Dash(__name__)\n\n# # Retrieve unique driver identifiers\n# drivers = session.laps['Driver'].unique()\n\n# app.layout = html.Div([\n#     html.H1(\"F1 Telemetry Visualization on Circuit Map\"),\n#     dcc.Dropdown(\n#         id='driver-dropdown',\n#         options=[{'label': drv, 'value': drv} for drv in drivers],\n#         value=drivers[0]\n#     ),\n#     dcc.Dropdown(\n#         id='lap-dropdown',\n#     ),\n#     dcc.Graph(\n#         id='telemetry-graph'\n#     )\n# ])\n\n# @app.callback(\n#     Output('lap-dropdown', 'options'),\n#     Input('driver-dropdown', 'value')\n# )\n# def set_lap_options(selected_driver):\n#     laps = session.laps.pick_driver(selected_driver)['LapNumber'].unique()\n#     return [{'label': f\"Lap {lap}\", 'value': lap} for lap in sorted(laps)]\n\n# @app.callback(\n#     Output('lap-dropdown', 'value'),\n#     Input('lap-dropdown', 'options')\n# )\n# def set_lap_value(available_options):\n#     return available_options[0]['value'] if available_options else None\n\n# @app.callback(\n#     Output('telemetry-graph', 'figure'),\n#     [Input('driver-dropdown', 'value'),\n#      Input('lap-dropdown', 'value')]\n# )\n# def update_graph(selected_driver, selected_lap):\n#     lap_data = session.laps.pick_driver(selected_driver).loc[session.laps['LapNumber'] == selected_lap]\n#     telemetry = lap_data.get_telemetry()\n    \n#     # Create hover text with detailed telemetry data using the correct column name 'nGear'\n#     hover_text = [\n#         f\"Speed: {s} km/h&lt;br&gt;Gear: {g}&lt;br&gt;Throttle: {t}%&lt;br&gt;DRS: {'Active' if d else 'Inactive'}&lt;br&gt;Brake: {b}%\"\n#         for s, g, t, d, b in zip(telemetry['Speed'], telemetry['nGear'], telemetry['Throttle'], telemetry['DRS'], telemetry['Brake'])\n#     ]\n\n#     # Plotting the telemetry data on a circuit map\n#     fig = go.Figure(data=go.Scatter(x=telemetry['X'], y=telemetry['Y'],\n#                                     mode='markers+lines',\n#                                     marker={'size': 5, 'color': telemetry['Speed'], 'colorscale': 'Viridis'},\n#                                     text=hover_text, hoverinfo='text'))\n\n#     # Update layout with appropriate titles and labels\n#     fig.update_layout(\n#         title=f\"Telemetry for {selected_driver} - Lap {selected_lap} on Monaco Circuit\",\n#         xaxis_title='X Position (meters)',\n#         yaxis_title='Y Position (meters)',\n#         legend_title=\"Telemetry Data\",\n#         template='plotly_dark'\n#     )\n    \n#     return fig\n\n# if __name__ == '__main__':\n#     app.run_server(debug=True,port=8080)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "DATA ALCHEMISTS",
    "section": "",
    "text": "DATA ALCHEMISTS\n\n\nFormula 1 Data Analysis\n\n\nTeam members\n\ngn178, Ganesh Arpan Nookala\nkn491, Kamala Prerna Nookala",
    "crumbs": [
      "DATA ALCHEMISTS"
    ]
  },
  {
    "objectID": "clean.html",
    "href": "clean.html",
    "title": "Data Alchemists",
    "section": "",
    "text": "import pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error\npd.set_option('display.max_columns', None)\n\n\n# Load data\nconstructor_standings_path = 'constructorstandings.csv'\nrace_results_path = 'raceresults.csv'\nqualifying_results_path = 'qualifyingresults.csv'\npit_stops_path = 'pitstops.csv'\n\n\nconstructor_standings_df = pd.read_csv(constructor_standings_path)\nrace_results_df = pd.read_csv(race_results_path)\nqualifying_results_df = pd.read_csv(qualifying_results_path)\npitstops_df = pd.read_csv(pit_stops_path)\n\n\npitstops_df['duration'] = pd.to_numeric(pitstops_df['duration'], errors='coerce')\n\n\n# Clean data\nconstructor_standings_df.drop(columns='Unnamed: 0', inplace=True)\npitstops_df.drop(columns='Unnamed: 0', inplace=True)\nqualifying_results_df.drop(columns='Unnamed: 0', inplace=True)\nrace_results_df.drop(columns='Unnamed: 0', inplace=True)\n\n\n# Merge datasets\nenhanced_constructor_data = pd.merge(constructor_standings_df, race_results_df,\n                                     on=['season', 'constructor_id', 'round'], suffixes=('_stand', '_race'))\nenhanced_constructor_data = pd.merge(enhanced_constructor_data, qualifying_results_df,\n                                     on=['season', 'constructor_id', 'round', 'driver_id'], suffixes=('', '_qual'))\nenhanced_constructor_data = pd.merge(enhanced_constructor_data, pitstops_df,\n                                     on=['season', 'driver_id', 'round'], how='left', suffixes=('', '_pit'))\n\n# Drop duplicates\nenhanced_constructor_data.drop_duplicates(inplace=True)\n\n\nenhanced_constructor_data.head()\n\n\n\n\n\n\n\n\nseason\nround\nconstructor_id\nposition_stand\npoints_stand\nwins\nrace_name\nposition_race\ndriver_id\nlaps\ntime\npoints_race\nrace_name_qual\nposition\nq1\nq2\nq3\nrace_name_pit\nstop\nlap\ntime_pit\nduration\n\n\n\n\n0\n2023\n1\nred_bull\n1\n43.0\n1\nBahrain Grand Prix\n1.0\nmax_verstappen\n57.0\n1:33:56.736\n25.0\nBahrain Grand Prix\n1.0\n1:31.295\n1:30.503\n1:29.708\nBahrain Grand Prix\n1.0\n14.0\n18:26:35\n24.289\n\n\n4\n2023\n1\nred_bull\n1\n43.0\n1\nBahrain Grand Prix\n2.0\nperez\n57.0\n+11.987\n18.0\nBahrain Grand Prix\n2.0\n1:31.479\n1:30.746\n1:29.846\nBahrain Grand Prix\n1.0\n17.0\n18:31:42\n24.264\n\n\n48\n2023\n1\naston_martin\n2\n23.0\n0\nBahrain Grand Prix\n3.0\nalonso\n57.0\n+38.637\n15.0\nBahrain Grand Prix\n5.0\n1:31.158\n1:30.645\n1:30.336\nBahrain Grand Prix\n1.0\n14.0\n18:27:02\n25.800\n\n\n52\n2023\n1\naston_martin\n2\n23.0\n0\nBahrain Grand Prix\n6.0\nstroll\n57.0\n+54.502\n8.0\nBahrain Grand Prix\n8.0\n1:31.184\n1:31.127\n1:30.836\nBahrain Grand Prix\n1.0\n15.0\n18:28:45\n25.449\n\n\n96\n2023\n1\nmercedes\n3\n16.0\n0\nBahrain Grand Prix\n5.0\nhamilton\n57.0\n+50.977\n10.0\nBahrain Grand Prix\n7.0\n1:31.543\n1:30.513\n1:30.384\nBahrain Grand Prix\n1.0\n12.0\n18:23:40\n24.682\n\n\n\n\n\n\n\n\n# Create new features\nenhanced_constructor_data['qualifying_race_position_delta'] = enhanced_constructor_data['position'] - enhanced_constructor_data['position_race']\nenhanced_constructor_data['average_qualifying_position'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['position'].transform('mean')\nenhanced_constructor_data['std_position_delta'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['qualifying_race_position_delta'].transform('std')\n\n# Filter data for specific constructors and seasons from 2012 onwards\nfiltered_constructors = ['ferrari', 'red_bull', 'mercedes']\nrecent_data = enhanced_constructor_data[\n    (enhanced_constructor_data['constructor_id'].isin(filtered_constructors)) & \n    (enhanced_constructor_data['season'] &gt;= 2012)\n]\n\n\n# Calculate performance metrics\nperformance_metrics = recent_data.groupby(['season', 'constructor_id']).agg(\n    average_finishing_position=pd.NamedAgg(column='position_race', aggfunc='mean'),\n    total_points=pd.NamedAgg(column='points_stand', aggfunc='sum'),\n    podium_finishes=pd.NamedAgg(column='position_race', aggfunc=lambda x: (x &lt;= 3).sum()),\n    average_pit_stop_duration=pd.NamedAgg(column='duration', aggfunc='mean'),\n    average_pit_stop_count=pd.NamedAgg(column='stop', aggfunc='count'),\n    mean_qualifying_position=pd.NamedAgg(column='average_qualifying_position', aggfunc='mean'),\n    mean_position_delta=pd.NamedAgg(column='qualifying_race_position_delta', aggfunc='mean'),\n    std_position_delta=pd.NamedAgg(column='std_position_delta', aggfunc='mean')\n).reset_index()\n\n\nrecent_data.head()\n\n\n\n\n\n\n\n\nseason\nround\nconstructor_id\nposition_stand\npoints_stand\nwins\nrace_name\nposition_race\ndriver_id\nlaps\ntime\npoints_race\nrace_name_qual\nposition\nq1\nq2\nq3\nrace_name_pit\nstop\nlap\ntime_pit\nduration\nqualifying_race_position_delta\naverage_qualifying_position\nstd_position_delta\n\n\n\n\n0\n2023\n1\nred_bull\n1\n43.0\n1\nBahrain Grand Prix\n1.0\nmax_verstappen\n57.0\n1:33:56.736\n25.0\nBahrain Grand Prix\n1.0\n1:31.295\n1:30.503\n1:29.708\nBahrain Grand Prix\n1.0\n14.0\n18:26:35\n24.289\n0.0\n6.774194\n6.045395\n\n\n4\n2023\n1\nred_bull\n1\n43.0\n1\nBahrain Grand Prix\n2.0\nperez\n57.0\n+11.987\n18.0\nBahrain Grand Prix\n2.0\n1:31.479\n1:30.746\n1:29.846\nBahrain Grand Prix\n1.0\n17.0\n18:31:42\n24.264\n0.0\n6.774194\n6.045395\n\n\n96\n2023\n1\nmercedes\n3\n16.0\n0\nBahrain Grand Prix\n5.0\nhamilton\n57.0\n+50.977\n10.0\nBahrain Grand Prix\n7.0\n1:31.543\n1:30.513\n1:30.384\nBahrain Grand Prix\n1.0\n12.0\n18:23:40\n24.682\n2.0\n6.353846\n6.598842\n\n\n97\n2023\n1\nmercedes\n3\n16.0\n0\nBahrain Grand Prix\n5.0\nhamilton\n57.0\n+50.977\n10.0\nBahrain Grand Prix\n7.0\n1:31.543\n1:30.513\n1:30.384\nBahrain Grand Prix\n2.0\n30.0\n18:53:36\n24.690\n2.0\n6.353846\n6.598842\n\n\n104\n2023\n1\nmercedes\n3\n16.0\n0\nBahrain Grand Prix\n7.0\nrussell\n57.0\n+55.873\n6.0\nBahrain Grand Prix\n6.0\n1:31.057\n1:30.507\n1:30.340\nBahrain Grand Prix\n1.0\n13.0\n18:25:24\n27.062\n-1.0\n6.353846\n6.598842\n\n\n\n\n\n\n\n\n\nperformance_metrics = recent_data.groupby(['season', 'constructor_id']).agg(\n    average_finishing_position=pd.NamedAgg(column='position_race', aggfunc='mean'),\n    total_points=pd.NamedAgg(column='points_stand', aggfunc='sum'),\n    podium_finishes=pd.NamedAgg(column='position_race', aggfunc=lambda x: (x &lt;= 3).sum()),\n    average_pit_stop_duration=pd.NamedAgg(column='duration', aggfunc='mean'),\n    average_pit_stop_count=pd.NamedAgg(column='stop', aggfunc='count'),\n    mean_qualifying_position=pd.NamedAgg(column='average_qualifying_position', aggfunc='mean'),\n    mean_position_delta=pd.NamedAgg(column='qualifying_race_position_delta', aggfunc='mean'),\n    std_position_delta=pd.NamedAgg(column='std_position_delta', aggfunc='mean')\n).reset_index()\n\n\nperformance_metrics.head()\n\n\n\n\n\n\n\n\nseason\nconstructor_id\naverage_finishing_position\ntotal_points\npodium_finishes\naverage_pit_stop_duration\naverage_pit_stop_count\nmean_qualifying_position\nmean_position_delta\nstd_position_delta\n\n\n\n\n0\n2012\nferrari\n7.142857\n8918.0\n17\n22.135404\n47\n8.816327\n1.673469\n5.125052\n\n\n1\n2012\nmercedes\n12.631579\n5321.0\n3\n22.318074\n54\n9.456140\n-3.175439\n7.171677\n\n\n2\n2012\nred_bull\n6.580000\n12536.0\n17\n22.060939\n49\n4.880000\n-1.700000\n6.728708\n\n\n3\n2013\nferrari\n6.633333\n11605.0\n16\n22.958483\n58\n7.183333\n0.550000\n5.013287\n\n\n4\n2013\nmercedes\n7.054545\n10909.0\n13\n23.113691\n55\n3.781818\n-3.272727\n5.254467\n\n\n\n\n\n\n\n\n# Define color codes for teams\nteam_colors = {\n    'ferrari': '#dc0000',\n    'mercedes': '#00d2be',\n    'red_bull': '#fcd700'\n}\n\n\n# # Prepare features and target for modeling\n# X = performance_metrics[['average_finishing_position', 'podium_finishes', 'average_pit_stop_count','average_pit_stop_duration',\n#                          'mean_qualifying_position', 'mean_position_delta', 'std_position_delta']]\n# y = performance_metrics['total_points']\n\n# # Split data into training and testing sets\n# X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# # Initialize and train the Random Forest Regressor\n# model = RandomForestRegressor(n_estimators=100, random_state=42)\n# model.fit(X_train, y_train)\n\n# # Predict on the test set\n# y_pred = model.predict(X_test)\n\n# # Calculate Mean Squared Error\n# mse = mean_squared_error(y_test, y_pred)\n\n\n# # Visualize data and results\n# fig, axes = plt.subplots(nrows=3, ncols=1, figsize=(10, 18))\n\n# # Average Finishing Position\n# for key, grp in performance_metrics.groupby('constructor_id'):\n#     axes[0].plot(grp['season'], grp['average_finishing_position'], marker='o', label=key.capitalize(), color=team_colors[key])\n# axes[0].set_title('Average Finishing Position Per Season')\n# axes[0].set_xlabel('Season')\n# axes[0].set_ylabel('Average Position')\n# axes[0].invert_yaxis()\n# axes[0].legend()\n# axes[0].grid(True)\n\n# # Total Points Per Season\n# for key, grp in performance_metrics.groupby('constructor_id'):\n#     axes[1].plot(grp['season'], grp['total_points'], marker='o', label=key.capitalize(), color=team_colors[key])\n# axes[1].set_title('Total Points Per Season')\n# axes[1].set_xlabel('Season')\n# axes[1].set_ylabel('Total Points')\n# axes[1].legend()\n# axes[1].grid(True)\n\n# # Podium Finishes\n# for key, grp in performance_metrics.groupby('constructor_id'):\n#     axes[2].bar(grp['season'], grp['podium_finishes'], label=key.capitalize(), color=team_colors[key])\n# axes[2].set_title('Podium Finishes Per Season')\n# axes[2].set_xlabel('Season')\n# axes[2].set_ylabel('Podium Finishes')\n# axes[2].legend()\n# axes[2].grid(True)\n\n# plt.tight_layout()\n# plt.show()\n\n# print(\"Model Mean Squared Error:\", mse)\n\n\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error\n\n# Load data\nconstructor_standings_df = pd.read_csv('constructorstandings.csv')\nrace_results_df = pd.read_csv('raceresults.csv')\nqualifying_results_df = pd.read_csv('qualifyingresults.csv')\npitstops_df = pd.read_csv('pitstops.csv')\n\n# Drop unnecessary 'Unnamed: 0' columns if present\ndatasets = [constructor_standings_df, race_results_df, qualifying_results_df, pitstops_df]\nfor dataset in datasets:\n    if 'Unnamed: 0' in dataset.columns:\n        dataset.drop(columns='Unnamed: 0', inplace=True)\n\n# Convert 'duration' column in pitstops_df to numeric, ignoring errors\npitstops_df['duration'] = pd.to_numeric(pitstops_df['duration'], errors='coerce')\n\n# Merging the dataframes\nenhanced_constructor_data = pd.merge(constructor_standings_df, race_results_df,\n                                     on=['season', 'constructor_id', 'round'], suffixes=('_stand', '_race'))\nenhanced_constructor_data = pd.merge(enhanced_constructor_data, qualifying_results_df,\n                                     on=['season', 'constructor_id', 'round', 'driver_id'], suffixes=('', '_qual'))\nenhanced_constructor_data = pd.merge(enhanced_constructor_data, pitstops_df,\n                                     on=['season', 'driver_id', 'round'], how='left', suffixes=('', '_pit'))\n\n# Drop duplicates\nenhanced_constructor_data.drop_duplicates(inplace=True)\n\n# Calculate additional performance metrics\nenhanced_constructor_data['total_points'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['points_race'].transform('sum')\nenhanced_constructor_data['podium_finishes'] = enhanced_constructor_data[enhanced_constructor_data['position_race'] &lt;= 3].groupby(['season', 'constructor_id'])['position_race'].transform('count')\nenhanced_constructor_data['average_finishing_position'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['position_race'].transform('mean')\nenhanced_constructor_data['average_pit_stop_duration'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['duration'].transform('mean')\nenhanced_constructor_data['average_pit_stop_count'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['stop'].transform('size')\n\n# Prepare data for modeling\nX = enhanced_constructor_data[['average_finishing_position', 'podium_finishes', 'average_pit_stop_count', 'average_pit_stop_duration']]\ny = enhanced_constructor_data['total_points']\n\n\nfrom sklearn.impute import SimpleImputer\n\n# Imputing missing values\nimputer = SimpleImputer(strategy='median')\nX_imputed = imputer.fit_transform(X)\n\n# Split data into training and testing sets\nX_train, X_test, y_train, y_test = train_test_split(X_imputed, y, test_size=0.2, random_state=42)\n\n# Initialize and train the Random Forest Regressor\nmodel = RandomForestRegressor(n_estimators=100, random_state=42)\nmodel.fit(X_train, y_train)\n\n# Predict on the test set\ny_pred = model.predict(X_test)\n\n# Calculate Mean Squared Error\nmse = mean_squared_error(y_test, y_pred)\n\nmse\n\n\n# Visualize data and results\nfig, axes = plt.subplots(nrows=3, ncols=1, figsize=(10, 18))\n\n# Average Finishing Position\nfor key, grp in performance_metrics.groupby('constructor_id'):\n    axes[0].plot(grp['season'], grp['average_finishing_position'], marker='o', label=key.capitalize(), color=team_colors[key])\naxes[0].set_title('Average Finishing Position Per Season')\naxes[0].set_xlabel('Season')\naxes[0].set_ylabel('Average Position')\naxes[0].invert_yaxis()\naxes[0].legend()\naxes[0].grid(True)\n\n# Total Points Per Season\nfor key, grp in performance_metrics.groupby('constructor_id'):\n    axes[1].plot(grp['season'], grp['total_points'], marker='o', label=key.capitalize(), color=team_colors[key])\naxes[1].set_title('Total Points Per Season')\naxes[1].set_xlabel('Season')\naxes[1].set_ylabel('Total Points')\naxes[1].legend()\naxes[1].grid(True)\n\n# Podium Finishes\nfor key, grp in performance_metrics.groupby('constructor_id'):\n    axes[2].bar(grp['season'], grp['podium_finishes'], label=key.capitalize(), color=team_colors[key])\naxes[2].set_title('Podium Finishes Per Season')\naxes[2].set_xlabel('Season')\naxes[2].set_ylabel('Podium Finishes')\naxes[2].legend()\naxes[2].grid(True)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"Model Mean Squared Error:\", mse)\n\n\n\n\n\n\n\n\nModel Mean Squared Error: 0.48031115413974756\n\n\n\nimport matplotlib.pyplot as plt\n\nplt.figure(figsize=(10, 6))\nplt.scatter(y_test, y_pred, color='blue', label='Predictions', alpha=0.5)\nplt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2)  # Line for perfect predictions\nplt.xlabel('Actual Points')\nplt.ylabel('Predicted Points')\nplt.title('Actual vs Predicted Total Points')\nplt.legend()\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\n# Example setup: Load your data frames (this part should be adjusted based on your actual data loading setup)\n# race_results_df = pd.read_csv('raceresults.csv')\n\n# Filter data for Max Verstappen and his team (assuming Red Bull and his driver_id is 'max_verstappen')\nverstappen_team_filter = race_results_df['constructor_id'] == 'red_bull'\nteam_data = race_results_df[verstappen_team_filter]\n\n# Group by season and driver to calculate total points\ndriver_points_per_season = team_data.groupby(['season', 'driver_id'])['points'].sum().unstack()\n\n# Plotting\nplt.figure(figsize=(12, 6))\nfor driver in driver_points_per_season.columns:\n    plt.plot(driver_points_per_season.index, driver_points_per_season[driver], marker='o', label=driver)\nplt.title('Comparison of Max Verstappen with Teammates Over Seasons')\nplt.xlabel('Season')\nplt.ylabel('Total Points')\nplt.legend(title='Driver')\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\n# Assuming qualifying_results_df is already loaded with relevant data\n# Filter data for Max Verstappen and his team (assuming Red Bull and an example driver_id like 'max_verstappen')\nverstappen_team_filter = qualifying_results_df['constructor_id'] == 'red_bull'\nteam_data = qualifying_results_df[verstappen_team_filter]\n\n# Group by season and driver to calculate average qualifying positions\ndriver_qualifying_per_season = team_data.groupby(['season', 'driver_id'])['position'].mean().unstack()\n\n# Plotting\nplt.figure(figsize=(12, 6))\nfor driver in driver_qualifying_per_season.columns:\n    plt.plot(driver_qualifying_per_season.index, driver_qualifying_per_season[driver], marker='o', label=driver)\nplt.title('Comparison of Max Verstappen with Teammates Based on Average Qualifying Position Over Seasons')\nplt.xlabel('Season')\nplt.ylabel('Average Qualifying Position')\nplt.legend(title='Driver')\nplt.gca().invert_yaxis()  # Invert y-axis to show the best qualifying positions (lowest numbers) at the top\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nimport numpy as np\nfrom sklearn.model_selection import learning_curve\ntrain_sizes, train_scores, test_scores = learning_curve(model, X_imputed, y, cv=5, train_sizes=np.linspace(.1, 1.0, 5))\ntrain_scores_mean = np.mean(train_scores, axis=1)\ntest_scores_mean = np.mean(test_scores, axis=1)\nplt.plot(train_sizes, train_scores_mean, 'o-', color=\"r\", label=\"Training score\")\nplt.plot(train_sizes, test_scores_mean, 'o-', color=\"g\", label=\"Cross-validation score\")\nplt.xlabel(\"Training examples\")\nplt.ylabel(\"Score\")\nplt.title('Learning Curve')\nplt.legend(loc=\"best\")\nplt.show()\n\n\n\n\n\n\n\n\n\nimportances = model.feature_importances_\nfeatures = ['Average Finishing Position', 'Podium Finishes', 'Average Pit Stop Count', 'Average Pit Stop Duration']\nplt.barh(features, importances)\nplt.xlabel('Importance')\nplt.title('Feature Importance')\nplt.show()\n\n\n\n\n\n\n\n\n\nresiduals = y_test - y_pred\nplt.scatter(y_test, residuals)\nplt.xlabel('Actual Total Points')\nplt.ylabel('Residuals')\nplt.axhline(y=0, color='r', linestyle='--')\nplt.title('Residual Plot')\nplt.show()\n\n\n\n\n\n\n\n\n\nfrom sklearn.metrics import mean_squared_error, r2_score\n\nmse = mean_squared_error(y_test, y_pred)\nr2 = r2_score(y_test, y_pred)\n\nprint(f\"Mean Squared Error: {mse}\")\nprint(f\"R-squared: {r2}\")\n\nMean Squared Error: 0.48031115413974756\nR-squared: 0.9999933590979309"
  },
  {
    "objectID": "20_reproducibility.html",
    "href": "20_reproducibility.html",
    "title": "20: Reproducibility",
    "section": "",
    "text": "To execute the code, one has to ensure that they have installed the required packages listed in the requirements.txt file. These packages contain dependencies necessary for the proper functioning of the codebase. One can install them using a package manager such as pip by running the following command:\npip install -r requirements.txt\n\nRequired Packages\nrequests\nsimplejson\npandas\nfastf1\nscikit-learn\nmatplotlib\nnumpy\npytest\npyyaml\nnbformat\nnbclient\njupyter\nplotly\nlogging",
    "crumbs": [
      "Project and software dev",
      "20: Reproducibility"
    ]
  },
  {
    "objectID": "18_continuous_integration.html",
    "href": "18_continuous_integration.html",
    "title": "18: Continuous Integration",
    "section": "",
    "text": "The Github Workflow is set to run on every wednesday to fetch the latest race data, and then the test file discussed in Tests is run, after this the quarto publish gets triggered.\nConsidering the Formula 1 Calendar, and the Ergast API update frequency the ideal data fetch would be the Wednesday of each week. # Github Workflow\nname: Automated Data Update and Publish\non:\n  schedule:\n    # Runs at 00:00 UTC every Wednesday\n    - cron: '0 0 * * 3'\n  push:\n    branches:\n      - main\njobs:\n  update-and-test:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out this repo\n        uses: actions/checkout@v4\n        with:\n          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }} # Use your PAT for checkout\n\n      - name: Setup Python 3.10\n        uses: actions/setup-python@v5\n        with:\n          python-version: \"3.10\"\n\n      - name: Install Python packages\n        run: pip install -r requirements.txt pytest pandas\n\n      - name: Run Data Loading Functions\n        run: python data_loading_functions.py\n\n      - name: Run Tests\n        run: pytest test_data_processing.py\n\n      - name: Commit changes\n        run: |\n          git config --global user.name 'arpannookala12'\n          git config --global user.email 'arpan.nookala@rutgers.edu'\n          git add -A\n          git commit -m \"Automated data update\" || echo \"No changes to commit\"\n          git push origin main\n\n  publish:\n    needs: update-and-test\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out this repo\n        uses: actions/checkout@v4\n        with:\n          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }} # Use your PAT for checkout\n\n      - name: Setup typst\n        uses: typst-community/setup-typst@v3\n\n      - name: Set up R\n        uses: r-lib/actions/setup-r@v2\n\n      - name: Install R packages\n        uses: r-lib/actions/setup-r-dependencies@v2\n        with:\n          packages: |\n            any::knitr \n            any::rmarkdown\n\n      - name: Setup Python 3.10\n        uses: actions/setup-python@v5\n        with:\n          python-version: \"3.10\"\n\n      - name: Install all necessary packages\n        run: pip install -r requirements.txt\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Use default GITHUB_TOKEN here for GitHub Pages",
    "crumbs": [
      "Project and software dev",
      "18: Continuous Integration"
    ]
  },
  {
    "objectID": "16_tests.html",
    "href": "16_tests.html",
    "title": "16: Tests",
    "section": "",
    "text": "The file test_data_processing.py contains basic tests, that are run after fetching the latest race data.\n\ndata_loading_functions.py\n\n\n\nCode\nimport requests\nimport pandas as pd\n\nrace_results_url = 'http://ergast.com/api/f1/current/last/results.json'\nresponse = requests.get(race_results_url)\ndata = response.json()\n\ndef fetch_race_results():\n    \"\"\"Process race results data to format suitable for saving to database.\"\"\"\n    race_results_url = 'http://ergast.com/api/f1/current/last/results.json'\n    response = requests.get(race_results_url)\n    data = response.json()\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        race = races[0]\n        results = race['Results']\n        df = pd.DataFrame({\n            'season': race['season'],\n            'race_name': race['raceName'],\n            'round': race['round'],\n            'position': [result['position'] for result in results],\n            'driver_id': [result['Driver']['driverId'] for result in results],\n            'constructor_id': [result['Constructor']['constructorId'] for result in results],\n            'laps': [result['laps'] for result in results],\n            'time': [result.get('Time', {}).get('time', 'N/A') for result in results],\n            'points': [result['points'] for result in results]\n        })\n        return df\n    return pd.DataFrame()\n\ndef fetch_qualifying_results():\n    race_results_url = 'http://ergast.com/api/f1/current/last/qualifying.json'\n    response = requests.get(race_results_url)\n    data = response.json()\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        qualifyings = races[0]['QualifyingResults']\n        df = pd.DataFrame({\n            'season': races[0]['season'],\n            'race_name': races[0]['raceName'],\n            'round': races[0]['round'],\n            'position': [qualifying['position'] for qualifying in qualifyings],\n            'driver_id': [qualifying['Driver']['driverId'] for qualifying in qualifyings],\n            'constructor_id': [qualifying['Constructor']['constructorId'] for qualifying in qualifyings],\n            'q1': [qualifying.get('Q1', 'N/A') for qualifying in qualifyings],\n            'q2': [qualifying.get('Q2', 'N/A') for qualifying in qualifyings],\n            'q3': [qualifying.get('Q3', 'N/A') for qualifying in qualifyings]\n        })\n        return df\n    return pd.DataFrame()\n\ndef fetch_pit_stops():\n    race_results_url = 'http://ergast.com/api/f1/current/last/pitstops.json'\n    response = requests.get(race_results_url)\n    data = response.json()\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        pit_stops = races[0].get('PitStops', [])\n        df = pd.DataFrame({\n            'season': races[0]['season'],\n            'round': races[0]['round'],\n            'race_name': races[0]['raceName'],\n            'driver_id': [pit['driverId'] for pit in pit_stops],\n            'stop': [pit['stop'] for pit in pit_stops],\n            'lap': [pit['lap'] for pit in pit_stops],\n            'time': [pit['time'] for pit in pit_stops],\n            'duration': [pit['duration'] for pit in pit_stops]\n        })\n        return df\n    return pd.DataFrame()\n\ndef fetch_constructor_standings():\n    race_results_url = 'http://ergast.com/api/f1/current/last/constructorStandings.json'\n    response = requests.get(race_results_url)\n    data = response.json()\n    standings = data['MRData']['StandingsTable']['StandingsLists']\n    standings1 = data['MRData']['StandingsTable']['StandingsLists']\n    if standings:\n        standings = standings[0]['ConstructorStandings']\n        df = pd.DataFrame({\n            'season': standings1[0]['season'],\n            'round': standings1[0]['round'],\n            'constructor_id': [standing['Constructor']['constructorId'] for standing in standings],\n            'position': [standing['position'] for standing in standings],\n            'points': [standing['points'] for standing in standings],\n            'wins': [standing['wins'] for standing in standings]\n        })\n        return df\n    return pd.DataFrame()\n\n\n\ntest_data_processing.py\n\n\n\nCode\nimport pytest\nimport pandas as pd\n\n# Assuming the functions to fetch data are named fetch_race_results, fetch_qualifying_results, etc.\n\nfrom data_loading_functions import fetch_race_results, fetch_qualifying_results, fetch_pit_stops, fetch_constructor_standings\n\ndef test_race_results():\n    df = fetch_race_results()\n    assert not df.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df) &gt; 1, \"Dataframe has too few rows\"\n    expected_columns = ['season', 'race_name', 'round', 'position', 'driver_id', 'constructor_id', 'laps', 'time', 'points']\n    assert (df.columns.tolist() == expected_columns), \"Dataframe columns do not match expected columns\"\n\ndef test_qualifying_results():\n    df1 = fetch_qualifying_results()\n    assert not df1.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df1) &gt; 1, \"Dataframe has too few rows\"\n    expected_columns = ['season',\n'race_name','round','position','driver_id',\n'constructor_id','q1','q2','q3']\n    assert (df1.columns.tolist() == expected_columns), \"Dataframe columns do not match expected columns\"\n\ndef test_pit_stops():\n    df2 = fetch_pit_stops()\n    assert not df2.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df2) &gt; 0, \"Dataframe has no rows\"\n    expected_columns = ['season','round',\n'race_name','driver_id','stop','lap',\n'time','duration']\n    assert (df2.columns.tolist() == expected_columns), \"Dataframe columns do not match expected columns\"\n\ndef test_constructor_standings():\n    df3 = fetch_constructor_standings()\n    assert not df3.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df3) &gt; 1, \"Dataframe has too few rows\"\n    expected_columns = ['season','round',\n'constructor_id','position','points',\n'wins']\n    assert (df3.columns.tolist() == expected_columns), \"Dataframe columns do not match expected columns\"",
    "crumbs": [
      "Project and software dev",
      "16: Tests"
    ]
  },
  {
    "objectID": "14_poster.html",
    "href": "14_poster.html",
    "title": "14: Poster",
    "section": "",
    "text": "Download Poster\n\n\n\n    This browser does not support PDFs. Please download the PDF to view it: &lt;a href=\"poster.pdf\"&gt;Download PDF&lt;/a&gt;.",
    "crumbs": [
      "Data Wrangling: Communicating results",
      "14: Poster"
    ]
  },
  {
    "objectID": "12_webpage.html",
    "href": "12_webpage.html",
    "title": "12: Webpage",
    "section": "",
    "text": "To publish the website, we utilized the Quarto Publish GitHub Action, which streamlined the process of generating and deploying the website directly from our GitHub repository. This action automatically builds the website from our Quarto files and publishes it online for easy access.\nWhenever a commit is pushed to the main branch: Our website is updated automatically\n\nGithub Workflow\nname: Publish Website\non:\n  workflow_dispatch:\n  push:\n    branches: main\n  workflow_call:\njobs:\n  publish:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out this repo\n        uses: actions/checkout@v4\n\n      - name: Setup typst\n        uses: typst-community/setup-typst@v3\n\n      - name: Set up R\n        uses: r-lib/actions/setup-r@v2\n      \n      - name: Install R packages\n        uses: r-lib/actions/setup-r-dependencies@v2\n        with:\n          packages: |\n            any::knitr \n            any::rmarkdown\n\n      - name: Setup Python 3.10\n        uses: actions/setup-python@v5\n        with:\n          python-version: \"3.10\"\n\n      - name: Install all necessary packages\n        run: pip install -r requirements.txt\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}",
    "crumbs": [
      "Data Wrangling: Communicating results",
      "12: Webpage"
    ]
  },
  {
    "objectID": "10_statistical_ML.html",
    "href": "10_statistical_ML.html",
    "title": "10: Statistical analisys",
    "section": "",
    "text": "All the work done under this section can be found in clean.ipynb.\nThe process is as follows: - Merge the 4 chosen datasets on the common identifier. - Compute performance metrics - Impute missing values using Scikits inbuilt functions - The goal is to predict the total number of points - We use RandomForestRegressor here for modeling\n\nLets look at the Actual vs predicted total points\n\n\n\n\n\n\n\n\n\n\nSource: clean.ipynb\n\n\nResidual Plot\n\n\n\n\n\n\n\n\n\n\n\n\n\nModel Learning Curve\n\n\n\n\n\n\n\n\n\n\n\n\n\nMSE & R-squared\n\n\n\nMean Squared Error: 0.48031115413974756\nR-squared: 0.9999933590979309",
    "crumbs": [
      "Data Wrangling: Analysis",
      "10: Statistical analisys"
    ]
  },
  {
    "objectID": "08_backup_external_service.html",
    "href": "08_backup_external_service.html",
    "title": "8: External services",
    "section": "",
    "text": "All the cached JSON data, sqlite databases, CSV files have been stored using Git LFS\nPlease navigate to each backup option in the Git Repository accordingly -\n\nFolder Name - cache (contains JSON backup)\nFolder Name - CSV (contains tidied data backup in CSV format)",
    "crumbs": [
      "Backups",
      "8: External services"
    ]
  },
  {
    "objectID": "06_test_quality.html",
    "href": "06_test_quality.html",
    "title": "6: Test data quality",
    "section": "",
    "text": "Below are basic tests that ensure that - There are no missing values in the dataset. - There are enough rows coming in. * * *\n\n\nCode\nimport requests\nimport pandas as pd\nimport json\nrace_results_url = 'http://ergast.com/api/f1/current/last/results.json'\nresponse = requests.get(race_results_url)\ndata = response.json()\nqualifying_standings_url = 'http://ergast.com/api/f1/current/last/qualifying.json'\nresponse2 = requests.get(qualifying_standings_url)\ndata2 = response2.json()\npit_stop_url = 'http://ergast.com/api/f1/current/last/pitstops.json'\nresponse3 = requests.get(pit_stop_url)\ndata3 = response3.json()\nconstructor_standings_url = 'http://ergast.com/api/f1/current/last/constructorStandings.json'\nresponse4 = requests.get(constructor_standings_url)\ndata4 = response4.json()\n\n# import json\n# file_path1 = 'C:\\\\Users\\\\arpan\\\\Desktop\\\\DATAWRANGLING\\\\group-project-data_alchemists\\\\cache\\\\2024\\\\race_results_5.json'\n# with open(file_path1, 'r') as file:\n#     data = json.load(file_path1)\nraces = data['MRData']['RaceTable']['Races']\nif races:\n    race = races[0]\n    results = race['Results']\n    df = pd.DataFrame({\n        'race_name': race['raceName'],\n        'round': race['round'],\n        'position': [result['position'] for result in results],\n        'driver_id': [result['Driver']['driverId'] for result in results],\n        'constructor_id': [result['Constructor']['constructorId'] for result in results],\n        'laps': [result['laps'] for result in results],\n        'time': [result.get('Time', {}).get('time', 'N/A') for result in results],\n        'points': [result['points'] for result in results]\n    })\n    # print(df.head())\n\n# file_path2 = 'C:\\\\Users\\\\arpan\\\\Desktop\\\\DATAWRANGLING\\\\group-project-data_alchemists\\\\cache\\\\2024\\\\qualifying_results_5.json'\n# with open(file_path2, 'r') as file:\n#     data2 = json.load(file_path2)\nraces1 = data2['MRData']['RaceTable']['Races']\nif races1:\n    qualifyings = races1[0]['QualifyingResults']\n    df1 = pd.DataFrame({\n        'race_name': races[0]['raceName'],\n        'round': races[0]['round'],\n        'position': [qualifying['position'] for qualifying in qualifyings],\n        'driver_id': [qualifying['Driver']['driverId'] for qualifying in qualifyings],\n        'constructor_id': [qualifying['Constructor']['constructorId'] for qualifying in qualifyings],\n        'q1': [qualifying.get('Q1', 'N/A') for qualifying in qualifyings],\n        'q2': [qualifying.get('Q2', 'N/A') for qualifying in qualifyings],\n        'q3': [qualifying.get('Q3', 'N/A') for qualifying in qualifyings]\n    })\n    # print(df1.head())\n\n# file_path3 = 'C:\\\\Users\\\\arpan\\\\Desktop\\\\DATAWRANGLING\\\\group-project-data_alchemists\\\\cache\\\\2024\\\\pit_stops_5.json'\n# with open(file_path3, 'r') as file:\n#     data3 = json.load(file_path3)\nraces2 = data3['MRData']['RaceTable']['Races']\nif races2:\n    pit_stops = races2[0].get('PitStops', [])\n    df2 = pd.DataFrame({\n        'race_name': races[0]['raceName'],\n        'driver_id': [pit['driverId'] for pit in pit_stops],\n        'stop': [pit['stop'] for pit in pit_stops],\n        'lap': [pit['lap'] for pit in pit_stops],\n        'time': [pit['time'] for pit in pit_stops],\n        'duration': [pit['duration'] for pit in pit_stops]\n    })\n    print(df2.head())\n# file_path4 = 'C:\\\\Users\\\\arpan\\\\Desktop\\\\DATAWRANGLING\\\\group-project-data_alchemists\\\\cache\\\\2024\\\\constructor_standings.json'\n# with open(file_path4, 'r') as file:\n#     data3 = json.load()\nstandings = data4['MRData']['StandingsTable']['StandingsLists']\nif standings:\n    standings = standings[0]['ConstructorStandings']\n    df3 = pd.DataFrame({\n        'constructor_id': [standing['Constructor']['constructorId'] for standing in standings],\n        'position': [standing['position'] for standing in standings],\n        'points': [standing['points'] for standing in standings],\n        'wins': [standing['wins'] for standing in standings]\n    })\n    # print(df3.head())\n\n\n              race_name  driver_id stop lap      time duration\n0  Singapore Grand Prix  ricciardo    1  10  20:20:46   30.316\n1  Singapore Grand Prix      albon    1  11  20:22:22   29.126\n2  Singapore Grand Prix      sainz    1  13  20:25:37   29.385\n3  Singapore Grand Prix   hamilton    1  17  20:31:54   29.272\n4  Singapore Grand Prix     alonso    1  25  20:45:21   29.251\n\n\n\nAssert statements\n\n\nCode\n# Test for dataframe df (Race Results)\ntry:\n    assert not df.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df) &gt; 1, \"Dataframe has too few rows, check API response\"\n    print(f\"Success: passed all checks.\")\nexcept AssertionError as e:\n    print(f\"Failed: {str(e)}\")\n\n# Test for dataframe df1 (Qualifying Results)\ntry:\n    assert not df1.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df1) &gt; 1, \"Dataframe has too few rows, check API response\"\n    print(f\"Success: passed all checks.\")\nexcept AssertionError as e:\n    print(f\"Failed: {str(e)}\")\n\n# Test for dataframe df2 (Pit Stops)\ntry:\n    assert not df2.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df2) &gt; 0, \"Dataframe has no rows, check if pit stops data exists\"\n    print(f\"Success: passed all checks.\")\nexcept AssertionError as e:\n    print(f\"Failed: {str(e)}\")\n\n# Test for dataframe df3 (Constructor Standings)\ntry:\n    assert not df3.isnull().values.any(), \"Dataframe contains NaN values\"\n    assert len(df3) &gt; 1, \"Dataframe has too few rows, check API response\"\n    print(f\"Success: passed all checks.\")\nexcept AssertionError as e:\n    print(f\"Failed: {str(e)}\")\n\n\nSuccess: passed all checks.\nSuccess: passed all checks.\nSuccess: passed all checks.\nSuccess: passed all checks.",
    "crumbs": [
      "Data Wrangling: enrichment/cleaning",
      "6: Test data quality"
    ]
  },
  {
    "objectID": "04_enrichment.html",
    "href": "04_enrichment.html",
    "title": "4: Data enrichment",
    "section": "",
    "text": "Please navigate to clean.ipynb in the git repository to look at the entire code for, data enrichment, data cleaning, feature engineering, modeling, and results.\nIn terms of data enrichment, we aggregate all the extracted datasets (Race Results, Qualifying Results, Pit Stops, Constructor Standings).\nBelow is the dataframe snapshot of the merged dataset, the merge was performed on a common identifier which is Season.\n\n\n\n\n\n\n\n\n\n\nseason\nround\nconstructor_id\nposition_stand\npoints_stand\nwins\nrace_name\nposition_race\ndriver_id\nlaps\ntime\npoints_race\nrace_name_qual\nposition\nq1\nq2\nq3\nrace_name_pit\nstop\nlap\ntime_pit\nduration\n\n\n\n\n0\n2023\n1\nred_bull\n1\n43.0\n1\nBahrain Grand Prix\n1.0\nmax_verstappen\n57.0\n1:33:56.736\n25.0\nBahrain Grand Prix\n1.0\n1:31.295\n1:30.503\n1:29.708\nBahrain Grand Prix\n1.0\n14.0\n18:26:35\n24.289\n\n\n4\n2023\n1\nred_bull\n1\n43.0\n1\nBahrain Grand Prix\n2.0\nperez\n57.0\n+11.987\n18.0\nBahrain Grand Prix\n2.0\n1:31.479\n1:30.746\n1:29.846\nBahrain Grand Prix\n1.0\n17.0\n18:31:42\n24.264\n\n\n48\n2023\n1\naston_martin\n2\n23.0\n0\nBahrain Grand Prix\n3.0\nalonso\n57.0\n+38.637\n15.0\nBahrain Grand Prix\n5.0\n1:31.158\n1:30.645\n1:30.336\nBahrain Grand Prix\n1.0\n14.0\n18:27:02\n25.800\n\n\n52\n2023\n1\naston_martin\n2\n23.0\n0\nBahrain Grand Prix\n6.0\nstroll\n57.0\n+54.502\n8.0\nBahrain Grand Prix\n8.0\n1:31.184\n1:31.127\n1:30.836\nBahrain Grand Prix\n1.0\n15.0\n18:28:45\n25.449\n\n\n96\n2023\n1\nmercedes\n3\n16.0\n0\nBahrain Grand Prix\n5.0\nhamilton\n57.0\n+50.977\n10.0\nBahrain Grand Prix\n7.0\n1:31.543\n1:30.513\n1:30.384\nBahrain Grand Prix\n1.0\n12.0\n18:23:40\n24.682\n\n\n\n\n\n\n\nSource: clean.ipynb\nThe other enrichment of the dataset is in terms of creating 5 features based on the dataset 1. Average Finishing Position 2. Podium Finishes 3. Average Pit Stop Count 4. Average Pit Stop Duration 5. Total Points\nCode Snippet\n# Create new features\nenhanced_constructor_data['qualifying_race_position_delta'] = enhanced_constructor_data['position'] - enhanced_constructor_data['position_race']\nenhanced_constructor_data['average_qualifying_position'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['position'].transform('mean')\nenhanced_constructor_data['std_position_delta'] = enhanced_constructor_data.groupby(['season', 'constructor_id'])['qualifying_race_position_delta'].transform('std')\n\n\n# Calculate performance metrics\nperformance_metrics = recent_data.groupby(['season', 'constructor_id']).agg(\n    average_finishing_position=pd.NamedAgg(column='position_race', aggfunc='mean'),\n    total_points=pd.NamedAgg(column='points_stand', aggfunc='sum'),\n    podium_finishes=pd.NamedAgg(column='position_race', aggfunc=lambda x: (x &lt;= 3).sum()),\n    average_pit_stop_duration=pd.NamedAgg(column='duration', aggfunc='mean'),\n    average_pit_stop_count=pd.NamedAgg(column='stop', aggfunc='count'),\n    mean_qualifying_position=pd.NamedAgg(column='average_qualifying_position', aggfunc='mean'),\n    mean_position_delta=pd.NamedAgg(column='qualifying_race_position_delta', aggfunc='mean'),\n    std_position_delta=pd.NamedAgg(column='std_position_delta', aggfunc='mean')\n).reset_index()\n\n\n\n\n\n\n\n\n\n\nseason\nconstructor_id\naverage_finishing_position\ntotal_points\npodium_finishes\naverage_pit_stop_duration\naverage_pit_stop_count\nmean_qualifying_position\nmean_position_delta\nstd_position_delta\n\n\n\n\n0\n2012\nferrari\n7.142857\n8918.0\n17\n22.135404\n47\n8.816327\n1.673469\n5.125052\n\n\n1\n2012\nmercedes\n12.631579\n5321.0\n3\n22.318074\n54\n9.456140\n-3.175439\n7.171677\n\n\n2\n2012\nred_bull\n6.580000\n12536.0\n17\n22.060939\n49\n4.880000\n-1.700000\n6.728708\n\n\n3\n2013\nferrari\n6.633333\n11605.0\n16\n22.958483\n58\n7.183333\n0.550000\n5.013287\n\n\n4\n2013\nmercedes\n7.054545\n10909.0\n13\n23.113691\n55\n3.781818\n-3.272727\n5.254467",
    "crumbs": [
      "Data Wrangling: enrichment/cleaning",
      "4: Data enrichment"
    ]
  },
  {
    "objectID": "02_automated_retrieval.html",
    "href": "02_automated_retrieval.html",
    "title": "2: Retrieval of raw data",
    "section": "",
    "text": "Fetching Data from the API\nThe code snippets attached below showcase the scenario where we wish to call the most recent race from the current Formula 1 season.\n\n\nRace Results JSON dump\n\n\nCode\nimport requests\n# Race Results\nrace_results_url = 'http://ergast.com/api/f1/current/last/results.json'\nresponse = requests.get(race_results_url)\ndata = response.json()\nraces = data['MRData']['RaceTable']['Races']\nprint(races)\n\n\n[{'season': '2024', 'round': '18', 'url': 'https://en.wikipedia.org/wiki/2024_Singapore_Grand_Prix', 'raceName': 'Singapore Grand Prix', 'Circuit': {'circuitId': 'marina_bay', 'url': 'http://en.wikipedia.org/wiki/Marina_Bay_Street_Circuit', 'circuitName': 'Marina Bay Street Circuit', 'Location': {'lat': '1.2914', 'long': '103.864', 'locality': 'Marina Bay', 'country': 'Singapore'}}, 'date': '2024-09-22', 'time': '12:00:00Z', 'Results': [{'number': '4', 'position': '1', 'positionText': '1', 'points': '25', 'Driver': {'driverId': 'norris', 'permanentNumber': '4', 'code': 'NOR', 'url': 'http://en.wikipedia.org/wiki/Lando_Norris', 'givenName': 'Lando', 'familyName': 'Norris', 'dateOfBirth': '1999-11-13', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}, 'grid': '1', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6052571', 'time': '1:40:52.571'}, 'FastestLap': {'rank': '2', 'lap': '48', 'Time': {'time': '1:34.925'}, 'AverageSpeed': {'units': 'kph', 'speed': '187.347'}}}, {'number': '1', 'position': '2', 'positionText': '2', 'points': '18', 'Driver': {'driverId': 'max_verstappen', 'permanentNumber': '33', 'code': 'VER', 'url': 'http://en.wikipedia.org/wiki/Max_Verstappen', 'givenName': 'Max', 'familyName': 'Verstappen', 'dateOfBirth': '1997-09-30', 'nationality': 'Dutch'}, 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}, 'grid': '2', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6073516', 'time': '+20.945'}, 'FastestLap': {'rank': '5', 'lap': '59', 'Time': {'time': '1:35.967'}, 'AverageSpeed': {'units': 'kph', 'speed': '185.313'}}}, {'number': '81', 'position': '3', 'positionText': '3', 'points': '15', 'Driver': {'driverId': 'piastri', 'permanentNumber': '81', 'code': 'PIA', 'url': 'http://en.wikipedia.org/wiki/Oscar_Piastri', 'givenName': 'Oscar', 'familyName': 'Piastri', 'dateOfBirth': '2001-04-06', 'nationality': 'Australian'}, 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}, 'grid': '5', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6094394', 'time': '+41.823'}, 'FastestLap': {'rank': '4', 'lap': '48', 'Time': {'time': '1:35.745'}, 'AverageSpeed': {'units': 'kph', 'speed': '185.743'}}}, {'number': '63', 'position': '4', 'positionText': '4', 'points': '12', 'Driver': {'driverId': 'russell', 'permanentNumber': '63', 'code': 'RUS', 'url': 'http://en.wikipedia.org/wiki/George_Russell_(racing_driver)', 'givenName': 'George', 'familyName': 'Russell', 'dateOfBirth': '1998-02-15', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}, 'grid': '4', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6113611', 'time': '+1:01.040'}, 'FastestLap': {'rank': '10', 'lap': '30', 'Time': {'time': '1:37.047'}, 'AverageSpeed': {'units': 'kph', 'speed': '183.251'}}}, {'number': '16', 'position': '5', 'positionText': '5', 'points': '10', 'Driver': {'driverId': 'leclerc', 'permanentNumber': '16', 'code': 'LEC', 'url': 'http://en.wikipedia.org/wiki/Charles_Leclerc', 'givenName': 'Charles', 'familyName': 'Leclerc', 'dateOfBirth': '1997-10-16', 'nationality': 'Monegasque'}, 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}, 'grid': '9', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6115001', 'time': '+1:02.430'}, 'FastestLap': {'rank': '3', 'lap': '46', 'Time': {'time': '1:35.371'}, 'AverageSpeed': {'units': 'kph', 'speed': '186.471'}}}, {'number': '44', 'position': '6', 'positionText': '6', 'points': '8', 'Driver': {'driverId': 'hamilton', 'permanentNumber': '44', 'code': 'HAM', 'url': 'http://en.wikipedia.org/wiki/Lewis_Hamilton', 'givenName': 'Lewis', 'familyName': 'Hamilton', 'dateOfBirth': '1985-01-07', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}, 'grid': '3', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6137819', 'time': '+1:25.248'}, 'FastestLap': {'rank': '12', 'lap': '43', 'Time': {'time': '1:37.393'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.600'}}}, {'number': '55', 'position': '7', 'positionText': '7', 'points': '6', 'Driver': {'driverId': 'sainz', 'permanentNumber': '55', 'code': 'SAI', 'url': 'http://en.wikipedia.org/wiki/Carlos_Sainz_Jr.', 'givenName': 'Carlos', 'familyName': 'Sainz', 'dateOfBirth': '1994-09-01', 'nationality': 'Spanish'}, 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}, 'grid': '10', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6148610', 'time': '+1:36.039'}, 'FastestLap': {'rank': '7', 'lap': '15', 'Time': {'time': '1:36.561'}, 'AverageSpeed': {'units': 'kph', 'speed': '184.173'}}}, {'number': '14', 'position': '8', 'positionText': '8', 'points': '4', 'Driver': {'driverId': 'alonso', 'permanentNumber': '14', 'code': 'ALO', 'url': 'http://en.wikipedia.org/wiki/Fernando_Alonso', 'givenName': 'Fernando', 'familyName': 'Alonso', 'dateOfBirth': '1981-07-29', 'nationality': 'Spanish'}, 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}, 'grid': '7', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '18', 'lap': '54', 'Time': {'time': '1:37.741'}, 'AverageSpeed': {'units': 'kph', 'speed': '181.950'}}}, {'number': '27', 'position': '9', 'positionText': '9', 'points': '2', 'Driver': {'driverId': 'hulkenberg', 'permanentNumber': '27', 'code': 'HUL', 'url': 'http://en.wikipedia.org/wiki/Nico_H%C3%BClkenberg', 'givenName': 'Nico', 'familyName': 'Hlkenberg', 'dateOfBirth': '1987-08-19', 'nationality': 'German'}, 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}, 'grid': '6', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '15', 'lap': '35', 'Time': {'time': '1:37.470'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.456'}}}, {'number': '11', 'position': '10', 'positionText': '10', 'points': '1', 'Driver': {'driverId': 'perez', 'permanentNumber': '11', 'code': 'PER', 'url': 'http://en.wikipedia.org/wiki/Sergio_P%C3%A9rez', 'givenName': 'Sergio', 'familyName': 'Prez', 'dateOfBirth': '1990-01-26', 'nationality': 'Mexican'}, 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}, 'grid': '13', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '16', 'lap': '33', 'Time': {'time': '1:37.477'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.443'}}}, {'number': '43', 'position': '11', 'positionText': '11', 'points': '0', 'Driver': {'driverId': 'colapinto', 'permanentNumber': '43', 'code': 'COL', 'url': 'http://en.wikipedia.org/wiki/Franco_Colapinto', 'givenName': 'Franco', 'familyName': 'Colapinto', 'dateOfBirth': '2003-05-27', 'nationality': 'Argentinian '}, 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}, 'grid': '12', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '11', 'lap': '35', 'Time': {'time': '1:37.262'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.846'}}}, {'number': '22', 'position': '12', 'positionText': '12', 'points': '0', 'Driver': {'driverId': 'tsunoda', 'permanentNumber': '22', 'code': 'TSU', 'url': 'http://en.wikipedia.org/wiki/Yuki_Tsunoda', 'givenName': 'Yuki', 'familyName': 'Tsunoda', 'dateOfBirth': '2000-05-11', 'nationality': 'Japanese'}, 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}, 'grid': '8', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '6', 'lap': '53', 'Time': {'time': '1:36.393'}, 'AverageSpeed': {'units': 'kph', 'speed': '184.494'}}}, {'number': '31', 'position': '13', 'positionText': '13', 'points': '0', 'Driver': {'driverId': 'ocon', 'permanentNumber': '31', 'code': 'OCO', 'url': 'http://en.wikipedia.org/wiki/Esteban_Ocon', 'givenName': 'Esteban', 'familyName': 'Ocon', 'dateOfBirth': '1996-09-17', 'nationality': 'French'}, 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}, 'grid': '15', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '20', 'lap': '48', 'Time': {'time': '1:37.964'}, 'AverageSpeed': {'units': 'kph', 'speed': '181.536'}}}, {'number': '18', 'position': '14', 'positionText': '14', 'points': '0', 'Driver': {'driverId': 'stroll', 'permanentNumber': '18', 'code': 'STR', 'url': 'http://en.wikipedia.org/wiki/Lance_Stroll', 'givenName': 'Lance', 'familyName': 'Stroll', 'dateOfBirth': '1998-10-29', 'nationality': 'Canadian'}, 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}, 'grid': '17', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '19', 'lap': '36', 'Time': {'time': '1:37.851'}, 'AverageSpeed': {'units': 'kph', 'speed': '181.745'}}}, {'number': '24', 'position': '15', 'positionText': '15', 'points': '0', 'Driver': {'driverId': 'zhou', 'permanentNumber': '24', 'code': 'ZHO', 'url': 'http://en.wikipedia.org/wiki/Zhou_Guanyu', 'givenName': 'Guanyu', 'familyName': 'Zhou', 'dateOfBirth': '1999-05-30', 'nationality': 'Chinese'}, 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}, 'grid': '20', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '14', 'lap': '47', 'Time': {'time': '1:37.461'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.472'}}}, {'number': '77', 'position': '16', 'positionText': '16', 'points': '0', 'Driver': {'driverId': 'bottas', 'permanentNumber': '77', 'code': 'BOT', 'url': 'http://en.wikipedia.org/wiki/Valtteri_Bottas', 'givenName': 'Valtteri', 'familyName': 'Bottas', 'dateOfBirth': '1989-08-28', 'nationality': 'Finnish'}, 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}, 'grid': '19', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '17', 'lap': '46', 'Time': {'time': '1:37.524'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.355'}}}, {'number': '10', 'position': '17', 'positionText': '17', 'points': '0', 'Driver': {'driverId': 'gasly', 'permanentNumber': '10', 'code': 'GAS', 'url': 'http://en.wikipedia.org/wiki/Pierre_Gasly', 'givenName': 'Pierre', 'familyName': 'Gasly', 'dateOfBirth': '1996-02-07', 'nationality': 'French'}, 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}, 'grid': '18', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '9', 'lap': '46', 'Time': {'time': '1:36.927'}, 'AverageSpeed': {'units': 'kph', 'speed': '183.478'}}}, {'number': '3', 'position': '18', 'positionText': '18', 'points': '0', 'Driver': {'driverId': 'ricciardo', 'permanentNumber': '3', 'code': 'RIC', 'url': 'http://en.wikipedia.org/wiki/Daniel_Ricciardo', 'givenName': 'Daniel', 'familyName': 'Ricciardo', 'dateOfBirth': '1989-07-01', 'nationality': 'Australian'}, 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}, 'grid': '16', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '1', 'lap': '60', 'Time': {'time': '1:34.486'}, 'AverageSpeed': {'units': 'kph', 'speed': '188.218'}}}, {'number': '20', 'position': '19', 'positionText': '19', 'points': '0', 'Driver': {'driverId': 'kevin_magnussen', 'permanentNumber': '20', 'code': 'MAG', 'url': 'http://en.wikipedia.org/wiki/Kevin_Magnussen', 'givenName': 'Kevin', 'familyName': 'Magnussen', 'dateOfBirth': '1992-10-05', 'nationality': 'Danish'}, 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}, 'grid': '14', 'laps': '57', 'status': 'Accident', 'FastestLap': {'rank': '13', 'lap': '52', 'Time': {'time': '1:37.425'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.540'}}}, {'number': '23', 'position': '20', 'positionText': 'R', 'points': '0', 'Driver': {'driverId': 'albon', 'permanentNumber': '23', 'code': 'ALB', 'url': 'http://en.wikipedia.org/wiki/Alexander_Albon', 'givenName': 'Alexander', 'familyName': 'Albon', 'dateOfBirth': '1996-03-23', 'nationality': 'Thai'}, 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}, 'grid': '11', 'laps': '15', 'status': 'Power Unit', 'FastestLap': {'rank': '8', 'lap': '13', 'Time': {'time': '1:36.888'}, 'AverageSpeed': {'units': 'kph', 'speed': '183.552'}}}]}]\n\n\n\n\nQualifying Results JSON dump\n\n\nCode\n# Qualifying Results\nqualifying_results_url = 'http://ergast.com/api/f1/current/last/qualifying.json'\nresponse = requests.get(qualifying_results_url)\ndata = response.json()\nquali = data['MRData']['RaceTable']['Races']\nprint(quali)\n\n\n[{'season': '2024', 'round': '18', 'url': 'https://en.wikipedia.org/wiki/2024_Singapore_Grand_Prix', 'raceName': 'Singapore Grand Prix', 'Circuit': {'circuitId': 'marina_bay', 'url': 'http://en.wikipedia.org/wiki/Marina_Bay_Street_Circuit', 'circuitName': 'Marina Bay Street Circuit', 'Location': {'lat': '1.2914', 'long': '103.864', 'locality': 'Marina Bay', 'country': 'Singapore'}}, 'date': '2024-09-22', 'time': '12:00:00Z', 'QualifyingResults': [{'number': '4', 'position': '1', 'Driver': {'driverId': 'norris', 'permanentNumber': '4', 'code': 'NOR', 'url': 'http://en.wikipedia.org/wiki/Lando_Norris', 'givenName': 'Lando', 'familyName': 'Norris', 'dateOfBirth': '1999-11-13', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}, 'Q1': '1:30.002', 'Q2': '1:30.007', 'Q3': '1:29.525'}, {'number': '1', 'position': '2', 'Driver': {'driverId': 'max_verstappen', 'permanentNumber': '33', 'code': 'VER', 'url': 'http://en.wikipedia.org/wiki/Max_Verstappen', 'givenName': 'Max', 'familyName': 'Verstappen', 'dateOfBirth': '1997-09-30', 'nationality': 'Dutch'}, 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}, 'Q1': '1:30.157', 'Q2': '1:29.680', 'Q3': '1:29.728'}, {'number': '44', 'position': '3', 'Driver': {'driverId': 'hamilton', 'permanentNumber': '44', 'code': 'HAM', 'url': 'http://en.wikipedia.org/wiki/Lewis_Hamilton', 'givenName': 'Lewis', 'familyName': 'Hamilton', 'dateOfBirth': '1985-01-07', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}, 'Q1': '1:30.393', 'Q2': '1:29.929', 'Q3': '1:29.841'}, {'number': '63', 'position': '4', 'Driver': {'driverId': 'russell', 'permanentNumber': '63', 'code': 'RUS', 'url': 'http://en.wikipedia.org/wiki/George_Russell_(racing_driver)', 'givenName': 'George', 'familyName': 'Russell', 'dateOfBirth': '1998-02-15', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}, 'Q1': '1:30.811', 'Q2': '1:30.153', 'Q3': '1:29.867'}, {'number': '81', 'position': '5', 'Driver': {'driverId': 'piastri', 'permanentNumber': '81', 'code': 'PIA', 'url': 'http://en.wikipedia.org/wiki/Oscar_Piastri', 'givenName': 'Oscar', 'familyName': 'Piastri', 'dateOfBirth': '2001-04-06', 'nationality': 'Australian'}, 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}, 'Q1': '1:30.258', 'Q2': '1:29.640', 'Q3': '1:29.953'}, {'number': '27', 'position': '6', 'Driver': {'driverId': 'hulkenberg', 'permanentNumber': '27', 'code': 'HUL', 'url': 'http://en.wikipedia.org/wiki/Nico_H%C3%BClkenberg', 'givenName': 'Nico', 'familyName': 'Hlkenberg', 'dateOfBirth': '1987-08-19', 'nationality': 'German'}, 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}, 'Q1': '1:30.724', 'Q2': '1:30.150', 'Q3': '1:30.115'}, {'number': '14', 'position': '7', 'Driver': {'driverId': 'alonso', 'permanentNumber': '14', 'code': 'ALO', 'url': 'http://en.wikipedia.org/wiki/Fernando_Alonso', 'givenName': 'Fernando', 'familyName': 'Alonso', 'dateOfBirth': '1981-07-29', 'nationality': 'Spanish'}, 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}, 'Q1': '1:30.684', 'Q2': '1:30.450', 'Q3': '1:30.214'}, {'number': '22', 'position': '8', 'Driver': {'driverId': 'tsunoda', 'permanentNumber': '22', 'code': 'TSU', 'url': 'http://en.wikipedia.org/wiki/Yuki_Tsunoda', 'givenName': 'Yuki', 'familyName': 'Tsunoda', 'dateOfBirth': '2000-05-11', 'nationality': 'Japanese'}, 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}, 'Q1': '1:30.710', 'Q2': '1:30.289', 'Q3': '1:30.354'}, {'number': '16', 'position': '9', 'Driver': {'driverId': 'leclerc', 'permanentNumber': '16', 'code': 'LEC', 'url': 'http://en.wikipedia.org/wiki/Charles_Leclerc', 'givenName': 'Charles', 'familyName': 'Leclerc', 'dateOfBirth': '1997-10-16', 'nationality': 'Monegasque'}, 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}, 'Q1': '1:30.786', 'Q2': '1:29.747'}, {'number': '55', 'position': '10', 'Driver': {'driverId': 'sainz', 'permanentNumber': '55', 'code': 'SAI', 'url': 'http://en.wikipedia.org/wiki/Carlos_Sainz_Jr.', 'givenName': 'Carlos', 'familyName': 'Sainz', 'dateOfBirth': '1994-09-01', 'nationality': 'Spanish'}, 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}, 'Q1': '1:30.670', 'Q2': '1:30.108'}, {'number': '23', 'position': '11', 'Driver': {'driverId': 'albon', 'permanentNumber': '23', 'code': 'ALB', 'url': 'http://en.wikipedia.org/wiki/Alexander_Albon', 'givenName': 'Alexander', 'familyName': 'Albon', 'dateOfBirth': '1996-03-23', 'nationality': 'Thai'}, 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}, 'Q1': '1:30.679', 'Q2': '1:30.474'}, {'number': '43', 'position': '12', 'Driver': {'driverId': 'colapinto', 'permanentNumber': '43', 'code': 'COL', 'url': 'http://en.wikipedia.org/wiki/Franco_Colapinto', 'givenName': 'Franco', 'familyName': 'Colapinto', 'dateOfBirth': '2003-05-27', 'nationality': 'Argentinian '}, 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}, 'Q1': '1:30.704', 'Q2': '1:30.481'}, {'number': '11', 'position': '13', 'Driver': {'driverId': 'perez', 'permanentNumber': '11', 'code': 'PER', 'url': 'http://en.wikipedia.org/wiki/Sergio_P%C3%A9rez', 'givenName': 'Sergio', 'familyName': 'Prez', 'dateOfBirth': '1990-01-26', 'nationality': 'Mexican'}, 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}, 'Q1': '1:30.624', 'Q2': '1:30.579'}, {'number': '20', 'position': '14', 'Driver': {'driverId': 'kevin_magnussen', 'permanentNumber': '20', 'code': 'MAG', 'url': 'http://en.wikipedia.org/wiki/Kevin_Magnussen', 'givenName': 'Kevin', 'familyName': 'Magnussen', 'dateOfBirth': '1992-10-05', 'nationality': 'Danish'}, 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}, 'Q1': '1:30.829', 'Q2': '1:30.653'}, {'number': '31', 'position': '15', 'Driver': {'driverId': 'ocon', 'permanentNumber': '31', 'code': 'OCO', 'url': 'http://en.wikipedia.org/wiki/Esteban_Ocon', 'givenName': 'Esteban', 'familyName': 'Ocon', 'dateOfBirth': '1996-09-17', 'nationality': 'French'}, 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}, 'Q1': '1:30.958', 'Q2': '1:30.769'}, {'number': '3', 'position': '16', 'Driver': {'driverId': 'ricciardo', 'permanentNumber': '3', 'code': 'RIC', 'url': 'http://en.wikipedia.org/wiki/Daniel_Ricciardo', 'givenName': 'Daniel', 'familyName': 'Ricciardo', 'dateOfBirth': '1989-07-01', 'nationality': 'Australian'}, 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}, 'Q1': '1:31.085'}, {'number': '18', 'position': '17', 'Driver': {'driverId': 'stroll', 'permanentNumber': '18', 'code': 'STR', 'url': 'http://en.wikipedia.org/wiki/Lance_Stroll', 'givenName': 'Lance', 'familyName': 'Stroll', 'dateOfBirth': '1998-10-29', 'nationality': 'Canadian'}, 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}, 'Q1': '1:31.094'}, {'number': '10', 'position': '18', 'Driver': {'driverId': 'gasly', 'permanentNumber': '10', 'code': 'GAS', 'url': 'http://en.wikipedia.org/wiki/Pierre_Gasly', 'givenName': 'Pierre', 'familyName': 'Gasly', 'dateOfBirth': '1996-02-07', 'nationality': 'French'}, 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}, 'Q1': '1:31.312'}, {'number': '77', 'position': '19', 'Driver': {'driverId': 'bottas', 'permanentNumber': '77', 'code': 'BOT', 'url': 'http://en.wikipedia.org/wiki/Valtteri_Bottas', 'givenName': 'Valtteri', 'familyName': 'Bottas', 'dateOfBirth': '1989-08-28', 'nationality': 'Finnish'}, 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}, 'Q1': '1:31.572'}, {'number': '24', 'position': '20', 'Driver': {'driverId': 'zhou', 'permanentNumber': '24', 'code': 'ZHO', 'url': 'http://en.wikipedia.org/wiki/Zhou_Guanyu', 'givenName': 'Guanyu', 'familyName': 'Zhou', 'dateOfBirth': '1999-05-30', 'nationality': 'Chinese'}, 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}, 'Q1': '1:32.054'}]}]\n\n\n\n\nPit Stops JSON dump\n\n\nCode\n# Pit Stops\npit_stops_url = 'http://ergast.com/api/f1/current/last/pitstops.json'\nresponse = requests.get(race_results_url)\ndata = response.json()\npitstops = data['MRData']['RaceTable']['Races']\nprint(pitstops)\n\n\n[{'season': '2024', 'round': '18', 'url': 'https://en.wikipedia.org/wiki/2024_Singapore_Grand_Prix', 'raceName': 'Singapore Grand Prix', 'Circuit': {'circuitId': 'marina_bay', 'url': 'http://en.wikipedia.org/wiki/Marina_Bay_Street_Circuit', 'circuitName': 'Marina Bay Street Circuit', 'Location': {'lat': '1.2914', 'long': '103.864', 'locality': 'Marina Bay', 'country': 'Singapore'}}, 'date': '2024-09-22', 'time': '12:00:00Z', 'Results': [{'number': '4', 'position': '1', 'positionText': '1', 'points': '25', 'Driver': {'driverId': 'norris', 'permanentNumber': '4', 'code': 'NOR', 'url': 'http://en.wikipedia.org/wiki/Lando_Norris', 'givenName': 'Lando', 'familyName': 'Norris', 'dateOfBirth': '1999-11-13', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}, 'grid': '1', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6052571', 'time': '1:40:52.571'}, 'FastestLap': {'rank': '2', 'lap': '48', 'Time': {'time': '1:34.925'}, 'AverageSpeed': {'units': 'kph', 'speed': '187.347'}}}, {'number': '1', 'position': '2', 'positionText': '2', 'points': '18', 'Driver': {'driverId': 'max_verstappen', 'permanentNumber': '33', 'code': 'VER', 'url': 'http://en.wikipedia.org/wiki/Max_Verstappen', 'givenName': 'Max', 'familyName': 'Verstappen', 'dateOfBirth': '1997-09-30', 'nationality': 'Dutch'}, 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}, 'grid': '2', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6073516', 'time': '+20.945'}, 'FastestLap': {'rank': '5', 'lap': '59', 'Time': {'time': '1:35.967'}, 'AverageSpeed': {'units': 'kph', 'speed': '185.313'}}}, {'number': '81', 'position': '3', 'positionText': '3', 'points': '15', 'Driver': {'driverId': 'piastri', 'permanentNumber': '81', 'code': 'PIA', 'url': 'http://en.wikipedia.org/wiki/Oscar_Piastri', 'givenName': 'Oscar', 'familyName': 'Piastri', 'dateOfBirth': '2001-04-06', 'nationality': 'Australian'}, 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}, 'grid': '5', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6094394', 'time': '+41.823'}, 'FastestLap': {'rank': '4', 'lap': '48', 'Time': {'time': '1:35.745'}, 'AverageSpeed': {'units': 'kph', 'speed': '185.743'}}}, {'number': '63', 'position': '4', 'positionText': '4', 'points': '12', 'Driver': {'driverId': 'russell', 'permanentNumber': '63', 'code': 'RUS', 'url': 'http://en.wikipedia.org/wiki/George_Russell_(racing_driver)', 'givenName': 'George', 'familyName': 'Russell', 'dateOfBirth': '1998-02-15', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}, 'grid': '4', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6113611', 'time': '+1:01.040'}, 'FastestLap': {'rank': '10', 'lap': '30', 'Time': {'time': '1:37.047'}, 'AverageSpeed': {'units': 'kph', 'speed': '183.251'}}}, {'number': '16', 'position': '5', 'positionText': '5', 'points': '10', 'Driver': {'driverId': 'leclerc', 'permanentNumber': '16', 'code': 'LEC', 'url': 'http://en.wikipedia.org/wiki/Charles_Leclerc', 'givenName': 'Charles', 'familyName': 'Leclerc', 'dateOfBirth': '1997-10-16', 'nationality': 'Monegasque'}, 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}, 'grid': '9', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6115001', 'time': '+1:02.430'}, 'FastestLap': {'rank': '3', 'lap': '46', 'Time': {'time': '1:35.371'}, 'AverageSpeed': {'units': 'kph', 'speed': '186.471'}}}, {'number': '44', 'position': '6', 'positionText': '6', 'points': '8', 'Driver': {'driverId': 'hamilton', 'permanentNumber': '44', 'code': 'HAM', 'url': 'http://en.wikipedia.org/wiki/Lewis_Hamilton', 'givenName': 'Lewis', 'familyName': 'Hamilton', 'dateOfBirth': '1985-01-07', 'nationality': 'British'}, 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}, 'grid': '3', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6137819', 'time': '+1:25.248'}, 'FastestLap': {'rank': '12', 'lap': '43', 'Time': {'time': '1:37.393'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.600'}}}, {'number': '55', 'position': '7', 'positionText': '7', 'points': '6', 'Driver': {'driverId': 'sainz', 'permanentNumber': '55', 'code': 'SAI', 'url': 'http://en.wikipedia.org/wiki/Carlos_Sainz_Jr.', 'givenName': 'Carlos', 'familyName': 'Sainz', 'dateOfBirth': '1994-09-01', 'nationality': 'Spanish'}, 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}, 'grid': '10', 'laps': '62', 'status': 'Finished', 'Time': {'millis': '6148610', 'time': '+1:36.039'}, 'FastestLap': {'rank': '7', 'lap': '15', 'Time': {'time': '1:36.561'}, 'AverageSpeed': {'units': 'kph', 'speed': '184.173'}}}, {'number': '14', 'position': '8', 'positionText': '8', 'points': '4', 'Driver': {'driverId': 'alonso', 'permanentNumber': '14', 'code': 'ALO', 'url': 'http://en.wikipedia.org/wiki/Fernando_Alonso', 'givenName': 'Fernando', 'familyName': 'Alonso', 'dateOfBirth': '1981-07-29', 'nationality': 'Spanish'}, 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}, 'grid': '7', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '18', 'lap': '54', 'Time': {'time': '1:37.741'}, 'AverageSpeed': {'units': 'kph', 'speed': '181.950'}}}, {'number': '27', 'position': '9', 'positionText': '9', 'points': '2', 'Driver': {'driverId': 'hulkenberg', 'permanentNumber': '27', 'code': 'HUL', 'url': 'http://en.wikipedia.org/wiki/Nico_H%C3%BClkenberg', 'givenName': 'Nico', 'familyName': 'Hlkenberg', 'dateOfBirth': '1987-08-19', 'nationality': 'German'}, 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}, 'grid': '6', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '15', 'lap': '35', 'Time': {'time': '1:37.470'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.456'}}}, {'number': '11', 'position': '10', 'positionText': '10', 'points': '1', 'Driver': {'driverId': 'perez', 'permanentNumber': '11', 'code': 'PER', 'url': 'http://en.wikipedia.org/wiki/Sergio_P%C3%A9rez', 'givenName': 'Sergio', 'familyName': 'Prez', 'dateOfBirth': '1990-01-26', 'nationality': 'Mexican'}, 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}, 'grid': '13', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '16', 'lap': '33', 'Time': {'time': '1:37.477'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.443'}}}, {'number': '43', 'position': '11', 'positionText': '11', 'points': '0', 'Driver': {'driverId': 'colapinto', 'permanentNumber': '43', 'code': 'COL', 'url': 'http://en.wikipedia.org/wiki/Franco_Colapinto', 'givenName': 'Franco', 'familyName': 'Colapinto', 'dateOfBirth': '2003-05-27', 'nationality': 'Argentinian '}, 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}, 'grid': '12', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '11', 'lap': '35', 'Time': {'time': '1:37.262'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.846'}}}, {'number': '22', 'position': '12', 'positionText': '12', 'points': '0', 'Driver': {'driverId': 'tsunoda', 'permanentNumber': '22', 'code': 'TSU', 'url': 'http://en.wikipedia.org/wiki/Yuki_Tsunoda', 'givenName': 'Yuki', 'familyName': 'Tsunoda', 'dateOfBirth': '2000-05-11', 'nationality': 'Japanese'}, 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}, 'grid': '8', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '6', 'lap': '53', 'Time': {'time': '1:36.393'}, 'AverageSpeed': {'units': 'kph', 'speed': '184.494'}}}, {'number': '31', 'position': '13', 'positionText': '13', 'points': '0', 'Driver': {'driverId': 'ocon', 'permanentNumber': '31', 'code': 'OCO', 'url': 'http://en.wikipedia.org/wiki/Esteban_Ocon', 'givenName': 'Esteban', 'familyName': 'Ocon', 'dateOfBirth': '1996-09-17', 'nationality': 'French'}, 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}, 'grid': '15', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '20', 'lap': '48', 'Time': {'time': '1:37.964'}, 'AverageSpeed': {'units': 'kph', 'speed': '181.536'}}}, {'number': '18', 'position': '14', 'positionText': '14', 'points': '0', 'Driver': {'driverId': 'stroll', 'permanentNumber': '18', 'code': 'STR', 'url': 'http://en.wikipedia.org/wiki/Lance_Stroll', 'givenName': 'Lance', 'familyName': 'Stroll', 'dateOfBirth': '1998-10-29', 'nationality': 'Canadian'}, 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}, 'grid': '17', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '19', 'lap': '36', 'Time': {'time': '1:37.851'}, 'AverageSpeed': {'units': 'kph', 'speed': '181.745'}}}, {'number': '24', 'position': '15', 'positionText': '15', 'points': '0', 'Driver': {'driverId': 'zhou', 'permanentNumber': '24', 'code': 'ZHO', 'url': 'http://en.wikipedia.org/wiki/Zhou_Guanyu', 'givenName': 'Guanyu', 'familyName': 'Zhou', 'dateOfBirth': '1999-05-30', 'nationality': 'Chinese'}, 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}, 'grid': '20', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '14', 'lap': '47', 'Time': {'time': '1:37.461'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.472'}}}, {'number': '77', 'position': '16', 'positionText': '16', 'points': '0', 'Driver': {'driverId': 'bottas', 'permanentNumber': '77', 'code': 'BOT', 'url': 'http://en.wikipedia.org/wiki/Valtteri_Bottas', 'givenName': 'Valtteri', 'familyName': 'Bottas', 'dateOfBirth': '1989-08-28', 'nationality': 'Finnish'}, 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}, 'grid': '19', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '17', 'lap': '46', 'Time': {'time': '1:37.524'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.355'}}}, {'number': '10', 'position': '17', 'positionText': '17', 'points': '0', 'Driver': {'driverId': 'gasly', 'permanentNumber': '10', 'code': 'GAS', 'url': 'http://en.wikipedia.org/wiki/Pierre_Gasly', 'givenName': 'Pierre', 'familyName': 'Gasly', 'dateOfBirth': '1996-02-07', 'nationality': 'French'}, 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}, 'grid': '18', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '9', 'lap': '46', 'Time': {'time': '1:36.927'}, 'AverageSpeed': {'units': 'kph', 'speed': '183.478'}}}, {'number': '3', 'position': '18', 'positionText': '18', 'points': '0', 'Driver': {'driverId': 'ricciardo', 'permanentNumber': '3', 'code': 'RIC', 'url': 'http://en.wikipedia.org/wiki/Daniel_Ricciardo', 'givenName': 'Daniel', 'familyName': 'Ricciardo', 'dateOfBirth': '1989-07-01', 'nationality': 'Australian'}, 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}, 'grid': '16', 'laps': '61', 'status': '+1 Lap', 'FastestLap': {'rank': '1', 'lap': '60', 'Time': {'time': '1:34.486'}, 'AverageSpeed': {'units': 'kph', 'speed': '188.218'}}}, {'number': '20', 'position': '19', 'positionText': '19', 'points': '0', 'Driver': {'driverId': 'kevin_magnussen', 'permanentNumber': '20', 'code': 'MAG', 'url': 'http://en.wikipedia.org/wiki/Kevin_Magnussen', 'givenName': 'Kevin', 'familyName': 'Magnussen', 'dateOfBirth': '1992-10-05', 'nationality': 'Danish'}, 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}, 'grid': '14', 'laps': '57', 'status': 'Accident', 'FastestLap': {'rank': '13', 'lap': '52', 'Time': {'time': '1:37.425'}, 'AverageSpeed': {'units': 'kph', 'speed': '182.540'}}}, {'number': '23', 'position': '20', 'positionText': 'R', 'points': '0', 'Driver': {'driverId': 'albon', 'permanentNumber': '23', 'code': 'ALB', 'url': 'http://en.wikipedia.org/wiki/Alexander_Albon', 'givenName': 'Alexander', 'familyName': 'Albon', 'dateOfBirth': '1996-03-23', 'nationality': 'Thai'}, 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}, 'grid': '11', 'laps': '15', 'status': 'Power Unit', 'FastestLap': {'rank': '8', 'lap': '13', 'Time': {'time': '1:36.888'}, 'AverageSpeed': {'units': 'kph', 'speed': '183.552'}}}]}]\n\n\n\n\nConstructor Standings JSON dump\n\n\nCode\n# Constructor Standings\nconstructor_standings_url = 'http://ergast.com/api/f1/current/last/constructorStandings.json'\nresponse = requests.get(constructor_standings_url)\ndata = response.json()\nstandings = data['MRData']['StandingsTable']['StandingsLists']\nstandings1 = data['MRData']['StandingsTable']['StandingsLists']\nprint(standings)\n\n\n[{'season': '2024', 'round': '18', 'ConstructorStandings': [{'position': '1', 'positionText': '1', 'points': '516', 'wins': '5', 'Constructor': {'constructorId': 'mclaren', 'url': 'http://en.wikipedia.org/wiki/McLaren', 'name': 'McLaren', 'nationality': 'British'}}, {'position': '2', 'positionText': '2', 'points': '475', 'wins': '7', 'Constructor': {'constructorId': 'red_bull', 'url': 'http://en.wikipedia.org/wiki/Red_Bull_Racing', 'name': 'Red Bull', 'nationality': 'Austrian'}}, {'position': '3', 'positionText': '3', 'points': '441', 'wins': '3', 'Constructor': {'constructorId': 'ferrari', 'url': 'http://en.wikipedia.org/wiki/Scuderia_Ferrari', 'name': 'Ferrari', 'nationality': 'Italian'}}, {'position': '4', 'positionText': '4', 'points': '329', 'wins': '3', 'Constructor': {'constructorId': 'mercedes', 'url': 'http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One', 'name': 'Mercedes', 'nationality': 'German'}}, {'position': '5', 'positionText': '5', 'points': '86', 'wins': '0', 'Constructor': {'constructorId': 'aston_martin', 'url': 'http://en.wikipedia.org/wiki/Aston_Martin_in_Formula_One', 'name': 'Aston Martin', 'nationality': 'British'}}, {'position': '6', 'positionText': '6', 'points': '34', 'wins': '0', 'Constructor': {'constructorId': 'rb', 'url': 'http://en.wikipedia.org/wiki/RB_Formula_One_Team', 'name': 'RB F1 Team', 'nationality': 'Italian'}}, {'position': '7', 'positionText': '7', 'points': '31', 'wins': '0', 'Constructor': {'constructorId': 'haas', 'url': 'http://en.wikipedia.org/wiki/Haas_F1_Team', 'name': 'Haas F1 Team', 'nationality': 'American'}}, {'position': '8', 'positionText': '8', 'points': '16', 'wins': '0', 'Constructor': {'constructorId': 'williams', 'url': 'http://en.wikipedia.org/wiki/Williams_Grand_Prix_Engineering', 'name': 'Williams', 'nationality': 'British'}}, {'position': '9', 'positionText': '9', 'points': '13', 'wins': '0', 'Constructor': {'constructorId': 'alpine', 'url': 'http://en.wikipedia.org/wiki/Alpine_F1_Team', 'name': 'Alpine F1 Team', 'nationality': 'French'}}, {'position': '10', 'positionText': '10', 'points': '0', 'wins': '0', 'Constructor': {'constructorId': 'sauber', 'url': 'http://en.wikipedia.org/wiki/Sauber_Motorsport', 'name': 'Sauber', 'nationality': 'Swiss'}}]}]",
    "crumbs": [
      "Data Wrangling: retrieval",
      "2: Retrieval of raw data"
    ]
  },
  {
    "objectID": "01_document_sources.html",
    "href": "01_document_sources.html",
    "title": "1: Data Sources",
    "section": "",
    "text": "Source:\nGo to API source\nThe primary data source for our Formula 1 race analysis project is the Ergast Motor Racing Data API. This publicly available API provides extensive historical data on Formula 1 races, drivers, lap times, circuits, and standings, among other statistics.\n\n\nInstitution:\nThe Ergast API is an independent project maintained by Chris Newell. It is not officially affiliated with the Formula 1 organization, but it aggregates data from various seasons of the Formula 1 World Championship.\n\n\nFormat of the Raw Data:\nThe API returns data in two main formats: JSON and XML.\n\n\nNature of the Data:\n\n\nContents:\nThe Ergast API provides detailed information on Formula 1 races dating back to the first World Championship in 1950. It includes data on race schedules, results, driver standings, constructor standings, qualifying times, lap times, and more. Each record contains various pieces of information, such as race dates, locations, drivers nationalities, teams, points awarded, and lap details.\n\n\nUpdates:\nThe data is updated regularly throughout the Formula 1 season, usually within a few days after each race. This ensures that the dataset includes the most recent race results and standings. The API also periodically incorporates historical data corrections and enhancements.\n\n\nAccessibility:\nThe API allows users to query specific subsets of data using URL parameters. This makes it easy to access specific information relevant to particular research questions or analysis needs. For example, users can request data for a specific season, race, driver, or team.\n\n\nUsage Limits:\nWhile the API is available for free and does not require an API key, it does have usage limits to ensure fair access and prevent abuse. Users are encouraged to cache responses and minimize repetitive requests to the same endpoints.",
    "crumbs": [
      "Data Wrangling: retrieval",
      "1: Data Sources"
    ]
  },
  {
    "objectID": "03_raw_to_tabular.html",
    "href": "03_raw_to_tabular.html",
    "title": "3: From raw to tabular data",
    "section": "",
    "text": "Transforming Raw Data from the Ergast API into pandas DataFrame\nExample of Race Result Extraction\n\n\nCode\nimport requests\nimport json\nimport pandas as pd\n# Race Results\nrace_results_url = 'http://ergast.com/api/f1/current/last/results.json'\nresponse = requests.get(race_results_url)\ndata = response.json()\nraces = data['MRData']['RaceTable']['Races']\nrace = races[0]\nresults = race['Results']\ndf = pd.DataFrame({\n    'season': race['season'],\n    'race_name': race['raceName'],\n    'round': race['round'],\n    'position': [result['position'] for result in results],\n    'driver_id': [result['Driver']['driverId'] for result in results],\n    'constructor_id': [result['Constructor']['constructorId'] for result in results],\n    'laps': [result['laps'] for result in results],\n    'time': [result.get('Time', {}).get('time', 'N/A') for result in results],\n    'points': [result['points'] for result in results]\n})\ndf.head()\n\n\n\n\n\n\n\n\n\nseason\nrace_name\nround\nposition\ndriver_id\nconstructor_id\nlaps\ntime\npoints\n\n\n\n\n0\n2024\nSingapore Grand Prix\n18\n1\nnorris\nmclaren\n62\n1:40:52.571\n25\n\n\n1\n2024\nSingapore Grand Prix\n18\n2\nmax_verstappen\nred_bull\n62\n+20.945\n18\n\n\n2\n2024\nSingapore Grand Prix\n18\n3\npiastri\nmclaren\n62\n+41.823\n15\n\n\n3\n2024\nSingapore Grand Prix\n18\n4\nrussell\nmercedes\n62\n+1:01.040\n12\n\n\n4\n2024\nSingapore Grand Prix\n18\n5\nleclerc\nferrari\n62\n+1:02.430\n10\n\n\n\n\n\n\n\nPlease navigate to data_extract.ipynb in the git repository to get the full code for extraction of data of all seasons since 1950.",
    "crumbs": [
      "Data Wrangling: retrieval",
      "3: From raw to tabular data"
    ]
  },
  {
    "objectID": "05_cleaning.html",
    "href": "05_cleaning.html",
    "title": "5: Data cleaning",
    "section": "",
    "text": "In terms of Data Cleaning, we just had to get rid of any unnecessary extra columns being created in the data extraction process.\n\n\nThe entire process can be found in clean.ipynb",
    "crumbs": [
      "Data Wrangling: enrichment/cleaning",
      "5: Data cleaning"
    ]
  },
  {
    "objectID": "07_format_conversion.html",
    "href": "07_format_conversion.html",
    "title": "7: Backup in several formats",
    "section": "",
    "text": "The data is backed up in 3 following formats\n\n1. SQLite3\nSQLite3 was selected as the primary storage format for the tidied data in the project due to its lightweight and self-contained nature, making it ideal for both development and production environments without the need for a separate server. This relational database management system enabled efficient querying and management of structured data. The tidied data, consisting of various metrics such as race results, driver statistics, and team performances, was stored in multiple relational tables. These tables were designed to optimize data retrieval and support complex queries, which are essential for analyzing performance trends and outcomes over multiple racing seasons.\n\n\n2. CSV\nCSV (Comma-Separated Values) files were used to facilitate intermediate data storage and manipulation. After retrieving and caching the raw data from the Ergast API in JSON format, the data was converted into pandas dataframes. These dataframes were then exported to CSV files to provide a human-readable and easily accessible format for initial data examination and cleaning. The use of CSV files supported a straightforward way to view and manipulate data in common spreadsheet applications, which was invaluable for spotting anomalies and ensuring data consistency before the final storage in the SQLite database.\n\n\n3. JSON\nThe initial data capture from the Ergast API was stored in JSON (JavaScript Object Notation) format, which provided a flexible and text-readable medium for handling the nested and hierarchical data from the API. JSONs format aligns well with the web-based data retrieval used in this project, allowing for efficient caching of raw API responses without additional transformation. This preserved the original structure and completeness of the data, facilitating accurate and comprehensive data parsing and transformation processes later in the workflow. JSON files served as the primary data input, ensuring that all subsequent data transformations remained traceable and aligned with the original source. * * *",
    "crumbs": [
      "Backups",
      "7: Backup in several formats"
    ]
  },
  {
    "objectID": "09_summary_stats.html",
    "href": "09_summary_stats.html",
    "title": "9: Summary statistics",
    "section": "",
    "text": "We compute some informative statistics on the merged dataset in the following manner:\nimport pandas as pd\ndf = pd.read_csv('mergeddata.csv')\n# df.drop(columns='Unnamed: 0', inplace=True)\n# Filter data for years 2020 to 2024\nfiltered_data = df[(df['season'] &gt;= 2020) & (df['season'] &lt;= 2024)]\n\n# Recalculate the requested summary statistics with the filtered data\n\n# 1. Average Points per Constructor\naverage_points_per_constructor_filtered = filtered_data.groupby('constructor_id')['points_stand'].mean()\n\n# 2. Average Pit Stop Duration\naverage_pit_stop_duration_filtered = filtered_data.groupby('constructor_id')['duration'].mean()\n\n# 3. Win Count per Driver\nwin_count_per_driver_filtered = filtered_data[filtered_data['position_race'] == 1].groupby('driver_id').size()\n\n# 4. Average Qualifying Position per Driver\naverage_qualifying_position_per_driver_filtered = filtered_data.groupby('driver_id')['position'].mean()\n\naverage_points_per_constructor_filtered, average_pit_stop_duration_filtered, win_count_per_driver_filtered, average_qualifying_position_per_driver_filtered\n\n\n\n(constructor_id\n ferrari     192.081590\n mercedes    268.712891\n red_bull    335.180147\n Name: points_stand, dtype: float64,\n constructor_id\n ferrari     24.457620\n mercedes    24.291416\n red_bull    24.008175\n Name: duration, dtype: float64,\n driver_id\n bottas             4\n hamilton          30\n leclerc            4\n max_verstappen    75\n perez              7\n russell            1\n sainz              4\n dtype: int64,\n driver_id\n albon              7.103448\n bearman           11.000000\n bottas             2.839286\n hamilton           4.650794\n leclerc            5.278689\n max_verstappen     2.805970\n perez              6.798165\n russell            6.297297\n sainz              5.450549\n vettel            12.080000\n Name: position, dtype: float64)\n\n\nSource: summarystats.ipynb",
    "crumbs": [
      "Data Wrangling: Analysis",
      "9: Summary statistics"
    ]
  },
  {
    "objectID": "11_visualizations.html",
    "href": "11_visualizations.html",
    "title": "11: Visualizations",
    "section": "",
    "text": "This page showcases the usage of the FastF1 python package to generate some highly informative, appealing, and unique visualiztions.\nThe code for these visualizations can be found in viz.ipynb\n\nPosition Comparison by Lap\n\n\n\n\n\n\n\n\n\n\nSource: viz.ipynb\n\n\nFastest Lap Comparison\n\n\n\n\n\n\n\n\n\n\n\n\n\nLaptimes with different tyre compounds\n\n\n\n\n\n\n\n\n\n\n\n\n\nGear Shifts in the fastest lap\n\n\n\n\n\n\n\n\n\n\n\n\n\nCircuit based speed map\n\n\n\n\n\n\n\n\n\n\n\n\n\nSpeed traces with corner annotations\n\n\n\n\n\n\n\n\n\n\n\n\n\nLap time distributions based on tyre compound\n\n\n\n['1', '14', '31', '44', '63', '16', '10', '55', '4', '81']\n['VER', 'ALO', 'OCO', 'HAM', 'RUS', 'LEC', 'GAS', 'SAI', 'NOR', 'PIA']\n{'LEC': '#dc0000', 'SAI': '#ff8181', 'SHW': '#9c0000', 'VER': '#fcd700', 'PER': '#ffec7b', 'DEN': '#907400', 'PIA': '#ff8700', 'NOR': '#eeb370', 'OWA': '#ee6d3a', 'GAS': '#fe86bc', 'OCO': '#ff117c', 'DOO': '#894667', 'BOT': '#00e701', 'ZHO': '#008d01', 'POU': '#004601', 'DEV': '#1e3d61', 'TSU': '#356cac', 'RIC': '#2b4562', 'LAW': '#2b4562', 'HAD': '#1e6176', 'IWA': '#1e6176', 'MAG': '#ffffff', 'HUL': '#cacaca', 'BEA': '#c40000', 'ALO': '#006f62', 'STR': '#00413b', 'DRU': '#2f9b90', 'HAM': '#00d2be', 'RUS': '#24ffff', 'VES': '#00a6ff', 'ALB': '#005aff', 'SAR': '#012564', 'OSU': '#1b3d97'}\n\n\n\n\n\n\n\n\n\n\n\n\nTrack map with numbered corners",
    "crumbs": [
      "Data Wrangling: Analysis",
      "11: Visualizations"
    ]
  },
  {
    "objectID": "13_interactive.html",
    "href": "13_interactive.html",
    "title": "13: Interactivity",
    "section": "",
    "text": "The interactive widget is a dash app that has a drop down for selecting the driver and the specific lap, for a particular race session, Upon hovering all telemetry data can be viewed",
    "crumbs": [
      "Data Wrangling: Communicating results",
      "13: Interactivity"
    ]
  },
  {
    "objectID": "17_continuous_testing.html",
    "href": "17_continuous_testing.html",
    "title": "17: Continuous Testing",
    "section": "",
    "text": "The Github Workflow is set to run on every wednesday to fetch the latest race data, and then the test file discussed in Tests is run, after this the quarto publish gets triggered.\nConsidering the Formula 1 Calendar, and the Ergast API update frequency the ideal data fetch would be the Wednesday of each week. # Github Workflow\nname: Automated Data Update and Publish\non:\n  schedule:\n    # Runs at 00:00 UTC every Wednesday\n    - cron: '0 0 * * 3'\n  push:\n    branches:\n      - main\njobs:\n  update-and-test:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out this repo\n        uses: actions/checkout@v4\n        with:\n          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }} # Use your PAT for checkout\n\n      - name: Setup Python 3.10\n        uses: actions/setup-python@v5\n        with:\n          python-version: \"3.10\"\n\n      - name: Install Python packages\n        run: pip install -r requirements.txt pytest pandas\n\n      - name: Run Data Loading Functions\n        run: python data_loading_functions.py\n\n      - name: Run Tests\n        run: pytest test_data_processing.py\n\n      - name: Commit changes\n        run: |\n          git config --global user.name 'arpannookala12'\n          git config --global user.email 'arpan.nookala@rutgers.edu'\n          git add -A\n          git commit -m \"Automated data update\" || echo \"No changes to commit\"\n          git push origin main\n\n  publish:\n    needs: update-and-test\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out this repo\n        uses: actions/checkout@v4\n        with:\n          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }} # Use your PAT for checkout\n\n      - name: Setup typst\n        uses: typst-community/setup-typst@v3\n\n      - name: Set up R\n        uses: r-lib/actions/setup-r@v2\n\n      - name: Install R packages\n        uses: r-lib/actions/setup-r-dependencies@v2\n        with:\n          packages: |\n            any::knitr \n            any::rmarkdown\n\n      - name: Setup Python 3.10\n        uses: actions/setup-python@v5\n        with:\n          python-version: \"3.10\"\n\n      - name: Install all necessary packages\n        run: pip install -r requirements.txt\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Use default GITHUB_TOKEN here for GitHub Pages",
    "crumbs": [
      "Project and software dev",
      "17: Continuous Testing"
    ]
  },
  {
    "objectID": "19_python_package.html",
    "href": "19_python_package.html",
    "title": "19: Python Package (Optional)",
    "section": "",
    "text": "Considering the wealth of features that the FastF1 package offers, we had all important and accessible functions offered by the library. We decided not to build a python package specific for the project, since the resource, sufficiently covers the scope that we wish to cover for this project.",
    "crumbs": [
      "Project and software dev",
      "19: Python Package (Optional)"
    ]
  },
  {
    "objectID": "backup.html",
    "href": "backup.html",
    "title": "Data Alchemists",
    "section": "",
    "text": "import pandas as pd\nimport sqlite3\n\n# Connect to SQLite database (this will create the database if it doesn't exist)\nconn = sqlite3.connect('f1_data.db')\n\n# List of CSV files and their corresponding table names in the database\ndata_files = {\n    'allconstructorstandings.csv': 'Constructor_Standings',\n    'alldriverstandings.csv': 'Driver_Standings',\n    'allfastestlaps.csv': 'Fastest_Laps',\n    'allpitstops.csv': 'Pit_Stops',\n    'allqualifyingresults.csv': 'Qualifying_Results',\n    'allraceresults.csv': 'Race_Results'\n}\n\n# Load each CSV file into the corresponding table\nfor file_path, table_name in data_files.items():\n    # Read the CSV file\n    df = pd.read_csv(file_path)\n    df.to_sql(table_name, conn, if_exists='replace', index=False)  # 'replace' to overwrite existing tables, 'append' to add data to existing tables\n\nconn.close()  # Close the database connection\n\n\nimport sqlite3\nimport pandas as pd\n\n# Connect to the database\nconn = sqlite3.connect('f1_data.db')\n\n# Execute a query\nquery = \"SELECT * FROM Race_Results\"\ndf = pd.read_sql_query(query, conn)\n\n# Print the results\nprint(df)\n\n# Close the connection\nconn.close()\n\n    Unnamed: 0            race_name  round  position       driver_id  \\\n0            0   Bahrain Grand Prix      1         1  max_verstappen   \n1            1   Bahrain Grand Prix      1         2           perez   \n2            2   Bahrain Grand Prix      1         3           sainz   \n3            3   Bahrain Grand Prix      1         4         leclerc   \n4            4   Bahrain Grand Prix      1         5         russell   \n..         ...                  ...    ...       ...             ...   \n74          15  Japanese Grand Prix      4        16           gasly   \n75          16  Japanese Grand Prix      4        17        sargeant   \n76          17  Japanese Grand Prix      4        18            zhou   \n77          18  Japanese Grand Prix      4        19       ricciardo   \n78          19  Japanese Grand Prix      4        20           albon   \n\n   constructor_id  laps         time  points  \n0        red_bull    57  1:31:44.742      26  \n1        red_bull    57      +22.457      18  \n2         ferrari    57      +25.110      15  \n3         ferrari    57      +39.669      12  \n4        mercedes    57      +46.788      10  \n..            ...   ...          ...     ...  \n74         alpine    52         None       0  \n75       williams    52         None       0  \n76         sauber    12         None       0  \n77             rb     0         None       0  \n78       williams     0         None       0  \n\n[79 rows x 9 columns]"
  },
  {
    "objectID": "data_extract.html",
    "href": "data_extract.html",
    "title": "Data Alchemists",
    "section": "",
    "text": "import os\nimport json\nimport requests\nimport sqlite3\nimport pandas as pd\n\ndef fetch_data(url, season, round, data_type):\n    \"\"\"Fetch data from the API, use caching to save and retrieve the data locally.\"\"\"\n    directory = f'cache/{season}'\n    filename = f'{directory}/{data_type}_{round}.json'\n    if not os.path.exists(directory):\n        os.makedirs(directory)\n\n    if os.path.isfile(filename):\n        with open(filename, 'r') as file:\n            return json.load(file)\n\n    response = requests.get(url)\n    data = response.json()\n    with open(filename, 'w') as file:\n        json.dump(data, file)\n    return data\n\ndef create_connection(db_file):\n    \"\"\"Create a database connection to a SQLite database.\"\"\"\n    try:\n        conn = sqlite3.connect(db_file)\n        return conn\n    except Exception as e:\n        print(e)\n    return None\n\ndef create_table(conn, create_table_sql):\n    \"\"\"Create a table from the create_table_sql statement.\"\"\"\n    try:\n        c = conn.cursor()\n        c.execute(create_table_sql)\n    except Exception as e:\n        print(e)\n\ndef save_data_to_db(df, table_name, conn):\n    \"\"\"Save pandas DataFrame to SQLite database table using an existing connection.\"\"\"\n    df.to_sql(table_name, conn, if_exists='append', index=False)\n\n\n\ndef process_race_results(data):\n    \"\"\"Process race results data to format suitable for saving to database.\"\"\"\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        race = races[0]\n        results = race['Results']\n        df = pd.DataFrame({\n            'season': race['season'],\n            'race_name': race['raceName'],\n            'round': race['round'],\n            'position': [result['position'] for result in results],\n            'driver_id': [result['Driver']['driverId'] for result in results],\n            'constructor_id': [result['Constructor']['constructorId'] for result in results],\n            'laps': [result['laps'] for result in results],\n            'time': [result.get('Time', {}).get('time', 'N/A') for result in results],\n            'points': [result['points'] for result in results]\n        })\n        return df\n    return pd.DataFrame()\n\ndef process_qualifying_results(data):\n    \"\"\"Process qualifying results data.\"\"\"\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        qualifyings = races[0]['QualifyingResults']\n        df = pd.DataFrame({\n            'season': races[0]['season'],\n            'race_name': races[0]['raceName'],\n            'round': races[0]['round'],\n            'position': [qualifying['position'] for qualifying in qualifyings],\n            'driver_id': [qualifying['Driver']['driverId'] for qualifying in qualifyings],\n            'constructor_id': [qualifying['Constructor']['constructorId'] for qualifying in qualifyings],\n            'q1': [qualifying.get('Q1', 'N/A') for qualifying in qualifyings],\n            'q2': [qualifying.get('Q2', 'N/A') for qualifying in qualifyings],\n            'q3': [qualifying.get('Q3', 'N/A') for qualifying in qualifyings]\n        })\n        return df\n    return pd.DataFrame()\n\ndef process_pit_stops(data):\n    \"\"\"Process pit stop data.\"\"\"\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        pit_stops = races[0].get('PitStops', [])\n        df = pd.DataFrame({\n            'season': races[0]['season'],\n            'round': races[0]['round'],\n            'race_name': races[0]['raceName'],\n            'driver_id': [pit['driverId'] for pit in pit_stops],\n            'stop': [pit['stop'] for pit in pit_stops],\n            'lap': [pit['lap'] for pit in pit_stops],\n            'time': [pit['time'] for pit in pit_stops],\n            'duration': [pit['duration'] for pit in pit_stops]\n        })\n        return df\n    return pd.DataFrame()\n\ndef process_driver_standings(data):\n    \"\"\"Process driver standings data.\"\"\"\n    standings = data['MRData']['StandingsTable']['StandingsLists']\n    standings1 = data['MRData']['StandingsTable']['StandingsLists']\n    if standings:\n        standings = standings[0]['DriverStandings']\n        df = pd.DataFrame({\n            'season': standings1[0]['season'],\n            'round': standings1[0]['round'],\n            'driver_id': [standing['Driver']['driverId'] for standing in standings],\n            'position': [standing['position'] for standing in standings],\n            'points': [standing['points'] for standing in standings],\n            'wins': [standing['wins'] for standing in standings]\n        })\n        return df\n    return pd.DataFrame()\n\ndef process_constructor_standings(data):\n    \"\"\"Process constructor standings data.\"\"\"\n    standings = data['MRData']['StandingsTable']['StandingsLists']\n    standings1 = data['MRData']['StandingsTable']['StandingsLists']\n    if standings:\n        standings = standings[0]['ConstructorStandings']\n        df = pd.DataFrame({\n            'season': standings1[0]['season'],\n            'round': standings1[0]['round'],\n            'constructor_id': [standing['Constructor']['constructorId'] for standing in standings],\n            'position': [standing['position'] for standing in standings],\n            'points': [standing['points'] for standing in standings],\n            'wins': [standing['wins'] for standing in standings]\n        })\n        return df\n    return pd.DataFrame()\n\ndef process_fastest_laps(data):\n    \"\"\"Process fastest laps data.\"\"\"\n    races = data['MRData']['RaceTable']['Races']\n    if races:\n        results = races[0]['Results']\n        df = pd.DataFrame({\n            'season': races[0]['season'],\n            'round': races[0]['round'],\n            'race_name': races[0]['raceName'],\n            'driver_id': [result['Driver']['driverId'] for result in results],\n            'lap': [result.get('FastestLap', {}).get('lap', 'N/A') for result in results],\n            'time': [result.get('FastestLap', {}).get('Time', {}).get('time', 'N/A') for result in results],\n            'speed': [result.get('FastestLap', {}).get('AverageSpeed', {}).get('speed', 'N/A') for result in results]\n        })\n        return df\n    return pd.DataFrame()\n\n\ndef fetch_all_seasons():\n    \"\"\"Fetch and return a list of all F1 seasons available from the Ergast API.\"\"\"\n    url = \"http://ergast.com/api/f1/seasons.json?limit=100\"  # Adjust limit if necessary\n    response = requests.get(url)\n    seasons = []\n\n    if response.status_code == 200:\n        data = response.json()\n        for item in data['MRData']['SeasonTable']['Seasons']:\n            seasons.append(item['season'])\n    else:\n        print(f\"Failed to fetch seasons data: Status code {response.status_code}\")\n        return None\n\n    return seasons\n\ndef fetch_season_rounds(season):\n    \"\"\"Fetch and return the number of rounds for a specific F1 season.\"\"\"\n    url = f\"http://ergast.com/api/f1/{season}.json\"\n    response = requests.get(url)\n    if response.status_code == 200:\n        data = response.json()\n        rounds = [race['round'] for race in data['MRData']['RaceTable']['Races']]\n        return rounds\n    else:\n        print(f\"Failed to fetch data for season {season}: {response.status_code}\")\n        return []\n\ndef fetch_race_schedule_for_all_seasons(seasons):\n    \"\"\"Fetch race schedules for a list of seasons and return a comprehensive DataFrame.\"\"\"\n    all_races = []\n\n    for year in seasons:\n        year_url = f\"http://ergast.com/api/f1/{year}.json\"\n        response = requests.get(year_url)\n        if response.status_code == 200:\n            data = response.json()\n            races = data['MRData']['RaceTable']['Races']\n            for race in races:\n                race_info = {\n                    'season': year,\n                    'round': race['round'],\n                    'race_name': race['raceName'],\n                    'circuit_id': race['Circuit']['circuitId'],\n                    'circuit_name': race['Circuit']['circuitName'],\n                    'country': race['Circuit']['Location']['country'],\n                    'city': race['Circuit']['Location']['locality'],\n                    'date': race['date'],\n                    'time': race.get('time', 'N/A')  # Include time if available\n                }\n                all_races.append(race_info)\n        else:\n            print(f\"Failed to fetch race schedule for {year}: Status code {response.status_code}\")\n\n    return pd.DataFrame(all_races)\n\n# First, fetch all available seasons\nseasons = fetch_all_seasons()\n\n# Check if the seasons list is not empty and proceed\nif seasons:\n    # Now, fetch race schedules for all these seasons\n    all_seasons_race_data = fetch_race_schedule_for_all_seasons(seasons)\nelse:\n    print(\"No seasons data available or failed to fetch seasons.\")\n\n\ndatabase = \"f1_data.db\"\nconn = create_connection(database)\nsql_create_tables = {\n        'race_results': \"\"\"\n            CREATE TABLE IF NOT EXISTS race_results (\n                season integer,\n                race_name text,\n                round integer,\n                position integer,\n                driver_id text,\n                constructor_id text,\n                laps integer,\n                time text,\n                points real\n            );\"\"\",\n        'driver_standings': \"\"\"\n            CREATE TABLE IF NOT EXISTS driver_standings (\n                season integer,\n                round integer,\n                driver_id text,\n                position integer,\n                points real,\n                wins integer\n            );\"\"\",\n        'constructor_standings': \"\"\"\n            CREATE TABLE IF NOT EXISTS constructor_standings ( \n                season integer,\n                round integer,\n                constructor_id text,\n                position integer,\n                points real,\n                wins integer\n            );\"\"\",\n        'qualifying_results': \"\"\"\n            CREATE TABLE IF NOT EXISTS qualifying_results (\n                season integer,\n                race_name text,\n                round integer,\n                position integer,\n                driver_id text,\n                constructor_id text,\n                q1 text,\n                q2 text,\n                q3 text\n            );\"\"\",\n        'pit_stops': \"\"\"\n            CREATE TABLE IF NOT EXISTS pit_stops (\n                season integer,\n                round integer,\n                race_name text,\n                driver_id text,\n                stop integer,\n                lap integer,\n                time text,\n                duration text\n            );\"\"\",\n        'race_schedule': \"\"\"\n            CREATE TABLE IF NOT EXISTS race_schedule (\n                season INTEGER,\n                round INTEGER,\n                race_name TEXT,\n                date TEXT\n                circuit_id INTEGER\n            );\"\"\"\n    }\n\n\ndef main():\n    conn = create_connection(database)\n    for table, sql in sql_create_tables.items():\n            create_table(conn, sql)\n\nif seasons:\n    for season in range(2024,2026):\n        rounds = fetch_season_rounds(season)  # Fetch the valid rounds for each season\n        for round in rounds:\n            race_results_url = f'http://ergast.com/api/f1/{season}/{round}/results.json'\n            race_result_data = fetch_data(race_results_url, season, round, 'race_results')\n            if race_result_data:\n                df_race_results = process_race_results(race_result_data)\n                save_data_to_db(df_race_results, 'race_results', conn)  # Assuming conn is your active db connection\n\n            # Fetch and process driver standings\n            driver_standings_url = f'http://ergast.com/api/f1/{season}/{round}/driverStandings.json'\n            driver_standings_data = fetch_data(driver_standings_url, season, round, 'driver_standings')\n            if driver_standings_data:\n                df_driver_standings = process_driver_standings(driver_standings_data)\n                save_data_to_db(df_driver_standings, 'driver_standings', conn)\n\n            # Fetch and process constructor standings\n            constructor_standings_url = f'http://ergast.com/api/f1/{season}/{round}/constructorStandings.json'\n            constructor_standings_data = fetch_data(constructor_standings_url, season, round, 'constructor_standings')\n            if constructor_standings_data:\n                df_constructor_standings = process_constructor_standings(constructor_standings_data)\n                save_data_to_db(df_constructor_standings, 'constructor_standings', conn)\n\n            # Fetch and process qualifying results\n            qualifying_results_url = f'http://ergast.com/api/f1/{season}/{round}/qualifying.json'\n            qualifying_result_data = fetch_data(qualifying_results_url, season, round, 'qualifying_results')\n            if qualifying_result_data:\n                df_qualifying_results = process_qualifying_results(qualifying_result_data)\n                save_data_to_db(df_qualifying_results, 'qualifying_results', conn)\n\n            # Fetch and process pit stops\n            pit_stops_url = f'http://ergast.com/api/f1/{season}/{round}/pitstops.json'\n            pit_stop_data = fetch_data(pit_stops_url, season, round, 'pit_stops')\n            if pit_stop_data:\n                df_pit_stops = process_pit_stops(pit_stop_data)\n                save_data_to_db(df_pit_stops, 'pit_stops', conn)\n\n        print(f\"Data saved for season {season}\")\nelse:\n    print(\"No seasons data available or failed to fetch seasons.\")\n        \n    if conn:\n        conn.close()\n\nif __name__ == \"__main__\":\n    main()\n\nData saved for season 2024\nData saved for season 2025\n\n\n\nsave_data_to_db(all_seasons_race_data,'race_schedule',conn)\n\n\nquery = \"SELECT * FROM race_results\"\ndf = pd.read_sql_query(query, conn)\ndf.to_csv('raceresults.csv')\n\nquery = \"SELECT * FROM qualifying_results\"\ndf = pd.read_sql_query(query, conn)\ndf.to_csv('qualifyingresults.csv')\n\nquery = \"SELECT * FROM constructor_standings\"\ndf = pd.read_sql_query(query, conn)\ndf.to_csv('constructorstandings.csv')\n\nquery = \"SELECT * FROM driver_standings\"\ndf = pd.read_sql_query(query, conn)\ndf.to_csv('driverstandings.csv')\n\nquery = \"SELECT * FROM race_schedule\"\ndf = pd.read_sql_query(query, conn)\ndf.to_csv('raceschedule.csv')"
  },
  {
    "objectID": "summarystats.html",
    "href": "summarystats.html",
    "title": "Data Alchemists",
    "section": "",
    "text": "import pandas as pd\ndf = pd.read_csv('mergeddata.csv')\n# df.drop(columns='Unnamed: 0', inplace=True)\n# Filter data for years 2020 to 2024\nfiltered_data = df[(df['season'] &gt;= 2020) & (df['season'] &lt;= 2024)]\n\n# Recalculate the requested summary statistics with the filtered data\n\n# 1. Average Points per Constructor\naverage_points_per_constructor_filtered = filtered_data.groupby('constructor_id')['points_stand'].mean()\n\n# 2. Average Pit Stop Duration\naverage_pit_stop_duration_filtered = filtered_data.groupby('constructor_id')['duration'].mean()\n\n# 3. Win Count per Driver\nwin_count_per_driver_filtered = filtered_data[filtered_data['position_race'] == 1].groupby('driver_id').size()\n\n# 4. Average Qualifying Position per Driver\naverage_qualifying_position_per_driver_filtered = filtered_data.groupby('driver_id')['position'].mean()\n\naverage_points_per_constructor_filtered, average_pit_stop_duration_filtered, win_count_per_driver_filtered, average_qualifying_position_per_driver_filtered\n\n(constructor_id\n ferrari     192.081590\n mercedes    268.712891\n red_bull    335.180147\n Name: points_stand, dtype: float64,\n constructor_id\n ferrari     24.457620\n mercedes    24.291416\n red_bull    24.008175\n Name: duration, dtype: float64,\n driver_id\n bottas             4\n hamilton          30\n leclerc            4\n max_verstappen    75\n perez              7\n russell            1\n sainz              4\n dtype: int64,\n driver_id\n albon              7.103448\n bearman           11.000000\n bottas             2.839286\n hamilton           4.650794\n leclerc            5.278689\n max_verstappen     2.805970\n perez              6.798165\n russell            6.297297\n sainz              5.450549\n vettel            12.080000\n Name: position, dtype: float64)"
  }
]